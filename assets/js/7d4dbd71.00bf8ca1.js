"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[4845],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=p(n),c=r,g=u["".concat(s,".").concat(c)]||u[c]||m[c]||i;return n?a.createElement(g,l(l({ref:t},d),{},{components:n})):a.createElement(g,l({ref:t},d))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[u]="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},3161:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const i={title:"Edge and Node.js Runtimes",description:"Learn about the switchable runtimes (Edge and Node.js) in Next.js."},l=void 0,o={unversionedId:"app/building-your-application/rendering/edge-and-nodejs-runtimes",id:"app/building-your-application/rendering/edge-and-nodejs-runtimes",title:"Edge and Node.js Runtimes",description:"Learn about the switchable runtimes (Edge and Node.js) in Next.js.",source:"@site/docs/02-app/01-building-your-application/03-rendering/04-edge-and-nodejs-runtimes.mdx",sourceDirName:"02-app/01-building-your-application/03-rendering",slug:"/app/building-your-application/rendering/edge-and-nodejs-runtimes",permalink:"/docs/app/building-your-application/rendering/edge-and-nodejs-runtimes",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-app/01-building-your-application/03-rendering/04-edge-and-nodejs-runtimes.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Edge and Node.js Runtimes",description:"Learn about the switchable runtimes (Edge and Node.js) in Next.js."},sidebar:"nextJsSidebar",previous:{title:"Composition Patterns",permalink:"/docs/app/building-your-application/rendering/composition-patterns"},next:{title:"Caching",permalink:"/docs/app/building-your-application/caching/"}},s={},p=[{value:"Runtime Differences",id:"runtime-differences",level:2},{value:"Edge Runtime",id:"edge-runtime",level:3},{value:"Node.js Runtime",id:"nodejs-runtime",level:3},{value:"Serverless Node.js",id:"serverless-nodejs",level:3},{value:"Examples",id:"examples",level:2},{value:"Segment Runtime Option",id:"segment-runtime-option",level:3}],d={toc:p},u="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"{/",(0,r.kt)("em",{parentName:"p"}," The content of this doc is shared between the app and pages router. You can use the component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. "),"/}"),(0,r.kt)("p",null,"In the context of Next.js, runtime refers to the set of libraries, APIs, and general functionality available to your code during execution."),(0,r.kt)("p",null,"On the server, there are two runtimes where parts of your application code can be rendered:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("strong",{parentName:"li"},"Node.js Runtime")," (default) has access to all Node.js APIs and compatible packages from the ecosystem."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("strong",{parentName:"li"},"Edge Runtime")," is based on ",(0,r.kt)("a",{parentName:"li",href:"/docs/app/api-reference/edge"},"Web APIs"),".")),(0,r.kt)("h2",{id:"runtime-differences"},"Runtime Differences"),(0,r.kt)("p",null,"There are many considerations to make when choosing a runtime. This table shows the major differences at a glance. If you want a more in-depth analysis of the differences, check out the sections below."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Node"),(0,r.kt)("th",{parentName:"tr",align:null},"Serverless"),(0,r.kt)("th",{parentName:"tr",align:null},"Edge"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://vercel.com/docs/concepts/get-started/compute#cold-and-hot-boots?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Cold Boot")),(0,r.kt)("td",{parentName:"tr",align:null},"/"),(0,r.kt)("td",{parentName:"tr",align:null},"~250ms"),(0,r.kt)("td",{parentName:"tr",align:null},"Instant")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/docs/app/building-your-application/routing/loading-ui-and-streaming"},"HTTP Streaming")),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"IO"),(0,r.kt)("td",{parentName:"tr",align:null},"All"),(0,r.kt)("td",{parentName:"tr",align:null},"All"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"fetch"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Scalability"),(0,r.kt)("td",{parentName:"tr",align:null},"/"),(0,r.kt)("td",{parentName:"tr",align:null},"High"),(0,r.kt)("td",{parentName:"tr",align:null},"Highest")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Security"),(0,r.kt)("td",{parentName:"tr",align:null},"Normal"),(0,r.kt)("td",{parentName:"tr",align:null},"High"),(0,r.kt)("td",{parentName:"tr",align:null},"High")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Latency"),(0,r.kt)("td",{parentName:"tr",align:null},"Normal"),(0,r.kt)("td",{parentName:"tr",align:null},"Low"),(0,r.kt)("td",{parentName:"tr",align:null},"Lowest")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"npm Packages"),(0,r.kt)("td",{parentName:"tr",align:null},"All"),(0,r.kt)("td",{parentName:"tr",align:null},"All"),(0,r.kt)("td",{parentName:"tr",align:null},"A smaller subset")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/docs/app/building-your-application/rendering/server-components#static-rendering-default"},"Static Rendering")),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"No")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/docs/app/building-your-application/rendering/server-components#dynamic-rendering"},"Dynamic Rendering")),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#revalidating-data"},"Data Revalidation w/ ",(0,r.kt)("inlineCode",{parentName:"a"},"fetch"))),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes")))),(0,r.kt)("h3",{id:"edge-runtime"},"Edge Runtime"),(0,r.kt)("p",null,"In Next.js, the lightweight Edge Runtime is a subset of available Node.js APIs."),(0,r.kt)("p",null,"The Edge Runtime is ideal if you need to deliver dynamic, personalized content at low latency with small, simple functions. The Edge Runtime's speed comes from its minimal use of resources, but that can be limiting in many scenarios."),(0,r.kt)("p",null,"For example, code executed in the Edge Runtime ",(0,r.kt)("a",{parentName:"p",href:"https://vercel.com/docs/concepts/limits/overview#edge-middleware-and-edge-functions-size"},"on Vercel cannot exceed between 1 MB and 4 MB"),", this limit includes imported packages, fonts and files, and will vary depending on your deployment infrastructure."),(0,r.kt)("h3",{id:"nodejs-runtime"},"Node.js Runtime"),(0,r.kt)("p",null,"Using the Node.js runtime gives you access to all Node.js APIs, and all npm packages that rely on them. However, it's not as fast to start up as routes using the Edge runtime."),(0,r.kt)("p",null,"Deploying your Next.js application to a Node.js server will require managing, scaling, and configuring your infrastructure. Alternatively, you can consider deploying your Next.js application to a serverless platform like Vercel, which will handle this for you."),(0,r.kt)("h3",{id:"serverless-nodejs"},"Serverless Node.js"),(0,r.kt)("p",null,"Serverless is ideal if you need a scalable solution that can handle more complex computational loads than the Edge Runtime. With Serverless Functions on Vercel, for example, your overall code size is ",(0,r.kt)("a",{parentName:"p",href:"https://vercel.com/docs/concepts/limits/overview#serverless-function-size"},"50MB")," including imported packages, fonts, and files."),(0,r.kt)("p",null,"The downside compared to routes using the ",(0,r.kt)("a",{parentName:"p",href:"https://vercel.com/docs/concepts/functions/edge-functions"},"Edge"),' is that it can take hundreds of milliseconds for Serverless Functions to boot up before they begin processing requests. Depending on the amount of traffic your site receives, this could be a frequent occurrence as the functions are not frequently "warm".'),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)("h3",{id:"segment-runtime-option"},"Segment Runtime Option"),(0,r.kt)("p",null,"You can specify a runtime for individual route segments in your Next.js application. To do so, ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/api-reference/file-conventions/route-segment-config"},"declare a variable called ",(0,r.kt)("inlineCode",{parentName:"a"},"runtime")," and export it"),". The variable must be a string, and must have a value of either ",(0,r.kt)("inlineCode",{parentName:"p"},"'nodejs'")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"'edge'")," runtime."),(0,r.kt)("p",null,"The following example demonstrates a page route segment that exports a ",(0,r.kt)("inlineCode",{parentName:"p"},"runtime")," with a value of ",(0,r.kt)("inlineCode",{parentName:"p"},"'edge'"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/page.tsx" switcher',filename:'"app/page.tsx"',switcher:!0},"export const runtime = \"edge\"; // 'nodejs' (default) | 'edge'\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/page.js" switcher',filename:'"app/page.js"',switcher:!0},"export const runtime = \"edge\"; // 'nodejs' (default) | 'edge'\n")),(0,r.kt)("p",null,"You can also define ",(0,r.kt)("inlineCode",{parentName:"p"},"runtime")," on a layout level, which will make all routes under the layout run on the edge runtime:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/layout.tsx" switcher',filename:'"app/layout.tsx"',switcher:!0},"export const runtime = \"edge\"; // 'nodejs' (default) | 'edge'\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/layout.js" switcher',filename:'"app/layout.js"',switcher:!0},"export const runtime = \"edge\"; // 'nodejs' (default) | 'edge'\n")),(0,r.kt)("p",null,"If the segment runtime is ",(0,r.kt)("em",{parentName:"p"},"not")," set, the default ",(0,r.kt)("inlineCode",{parentName:"p"},"nodejs")," runtime will be used. You do not need to use the ",(0,r.kt)("inlineCode",{parentName:"p"},"runtime")," option if you do not plan to change from the Node.js runtime."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Please refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/docs/latest/api/"},"Node.js Docs")," and ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/api-reference/edge"},"Edge Docs")," for the full list of available APIs. Both runtimes can also support ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/loading-ui-and-streaming"},"streaming")," depending on your deployment infrastructure.")))}m.isMDXComponent=!0}}]);