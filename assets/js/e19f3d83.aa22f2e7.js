"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[1573],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>k});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(a),u=r,k=d["".concat(p,".").concat(u)]||d[u]||m[u]||i;return a?n.createElement(k,o(o({ref:t},c),{},{components:a})):n.createElement(k,o({ref:t},c))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[d]="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=a[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},4021:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var n=a(7462),r=(a(7294),a(3905));const i={title:"Route Segment Config",description:"Learn about how to configure options for Next.js route segments."},o=void 0,l={unversionedId:"app/api-reference/file-conventions/route-segment-config",id:"app/api-reference/file-conventions/route-segment-config",title:"Route Segment Config",description:"Learn about how to configure options for Next.js route segments.",source:"@site/docs/02-app/02-api-reference/02-file-conventions/route-segment-config.mdx",sourceDirName:"02-app/02-api-reference/02-file-conventions",slug:"/app/api-reference/file-conventions/route-segment-config",permalink:"/docs/app/api-reference/file-conventions/route-segment-config",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-app/02-api-reference/02-file-conventions/route-segment-config.mdx",tags:[],version:"current",frontMatter:{title:"Route Segment Config",description:"Learn about how to configure options for Next.js route segments."},sidebar:"tutorialSidebar",previous:{title:"page.js",permalink:"/docs/app/api-reference/file-conventions/page"},next:{title:"route.js",permalink:"/docs/app/api-reference/file-conventions/route"}},p={},s=[{value:"Options",id:"options",level:2},{value:"<code>dynamic</code>",id:"dynamic",level:3},{value:"<code>dynamicParams</code>",id:"dynamicparams",level:3},{value:"<code>revalidate</code>",id:"revalidate",level:3},{value:"Revalidation Frequency",id:"revalidation-frequency",level:4},{value:"<code>fetchCache</code>",id:"fetchcache",level:3},{value:"Cross-route segment behavior",id:"cross-route-segment-behavior",level:4},{value:"<code>runtime</code>",id:"runtime",level:3},{value:"<code>preferredRegion</code>",id:"preferredregion",level:3},{value:"<code>maxDuration</code>",id:"maxduration",level:3},{value:"<code>generateStaticParams</code>",id:"generatestaticparams",level:3}],c={toc:s},d="wrapper";function m(e){let{components:t,...a}=e;return(0,r.kt)(d,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The Route Segment options allows you configure the behavior of a ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/pages-and-layouts"},"Page"),", ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/pages-and-layouts"},"Layout"),", or ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/route-handlers"},"Route Handler")," by directly exporting the following variables:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Option"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Default"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#dynamic"},(0,r.kt)("inlineCode",{parentName:"a"},"dynamic"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"'auto' \\| 'force-dynamic' \\| 'error' \\| 'force-static'")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"'auto'"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#dynamicparams"},(0,r.kt)("inlineCode",{parentName:"a"},"dynamicParams"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"boolean")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"true"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#revalidate"},(0,r.kt)("inlineCode",{parentName:"a"},"revalidate"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false \\| 'force-cache' \\| 0 \\| number")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#fetchcache"},(0,r.kt)("inlineCode",{parentName:"a"},"fetchCache"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"'auto' \\| 'default-cache' \\| 'only-cache' \\| 'force-cache' \\| 'force-no-store' \\| 'default-no-store' \\| 'only-no-store'")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"'auto'"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#runtime"},(0,r.kt)("inlineCode",{parentName:"a"},"runtime"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"'nodejs' \\| 'edge'")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"'nodejs'"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#preferredregion"},(0,r.kt)("inlineCode",{parentName:"a"},"preferredRegion"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"'auto' \\| 'global' \\| 'home' \\| string \\| string[]")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"'auto'"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#maxduration"},(0,r.kt)("inlineCode",{parentName:"a"},"maxDuration"))),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"number")),(0,r.kt)("td",{parentName:"tr",align:null},"Set by deployment platform")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="layout.tsx | page.tsx | route.ts" switcher',filename:'"layout.tsx',"|":!0,"page.tsx":!0,'route.ts"':!0,switcher:!0},"export const dynamic = 'auto'\nexport const dynamicParams = true\nexport const revalidate = false\nexport const fetchCache = 'auto'\nexport const runtime = 'nodejs'\nexport const preferredRegion = 'auto'\nexport const maxDuration = 5\n\nexport default function MyComponent() {}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="layout.js | page.js | route.js" switcher',filename:'"layout.js',"|":!0,"page.js":!0,'route.js"':!0,switcher:!0},"export const dynamic = 'auto'\nexport const dynamicParams = true\nexport const revalidate = false\nexport const fetchCache = 'auto'\nexport const runtime = 'nodejs'\nexport const preferredRegion = 'auto'\nexport const maxDuration = 5\n\nexport default function MyComponent() {}\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"The values of the config options currently need be statically analyzable. For example ",(0,r.kt)("inlineCode",{parentName:"li"},"revalidate = 600")," is valid, but ",(0,r.kt)("inlineCode",{parentName:"li"},"revalidate = 60 * 10")," is not."))),(0,r.kt)("h2",{id:"options"},"Options"),(0,r.kt)("h3",{id:"dynamic"},(0,r.kt)("inlineCode",{parentName:"h3"},"dynamic")),(0,r.kt)("p",null,"Change the dynamic behavior of a layout or page to fully static or fully dynamic."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="layout.tsx | page.tsx | route.ts" switcher',filename:'"layout.tsx',"|":!0,"page.tsx":!0,'route.ts"':!0,switcher:!0},"export const dynamic = 'auto'\n// 'auto' | 'force-dynamic' | 'error' | 'force-static'\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="layout.js | page.js | route.js" switcher',filename:'"layout.js',"|":!0,"page.js":!0,'route.js"':!0,switcher:!0},"export const dynamic = 'auto'\n// 'auto' | 'force-dynamic' | 'error' | 'force-static'\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know"),": The new model in the ",(0,r.kt)("inlineCode",{parentName:"p"},"app")," directory favors granular caching control at the ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," request level over the binary all-or-nothing model of ",(0,r.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"getStaticProps")," at the page-level in the ",(0,r.kt)("inlineCode",{parentName:"p"},"pages")," directory. The ",(0,r.kt)("inlineCode",{parentName:"p"},"dynamic")," option is a way to opt back in to the previous model as a convenience and provides a simpler migration path.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"'auto'"))," (default): The default option to cache as much as possible without preventing any components from opting into dynamic behavior.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"'force-dynamic'")),": Force dynamic rendering and uncached data fetching of a layout or page by disabling all caching of ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," requests and always revalidating. This option is equivalent to:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getServerSideProps()")," in the ",(0,r.kt)("inlineCode",{parentName:"li"},"pages")," directory."),(0,r.kt)("li",{parentName:"ul"},"Setting the option of every ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch()")," request in a layout or page to ",(0,r.kt)("inlineCode",{parentName:"li"},"{ cache: 'no-store', next: { revalidate: 0 } }"),"."),(0,r.kt)("li",{parentName:"ul"},"Setting the segment config to ",(0,r.kt)("inlineCode",{parentName:"li"},"export const fetchCache = 'force-no-store'")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"'error'")),": Force static rendering and cache the data of a layout or page by causing an error if any components use ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/rendering/server-components#server-rendering-strategies#dynamic-functions"},"dynamic functions")," or uncached data. This option is equivalent to:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"getStaticProps()")," in the ",(0,r.kt)("inlineCode",{parentName:"li"},"pages")," directory."),(0,r.kt)("li",{parentName:"ul"},"Setting the option of every ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch()")," request in a layout or page to ",(0,r.kt)("inlineCode",{parentName:"li"},"{ cache: 'force-cache' }"),"."),(0,r.kt)("li",{parentName:"ul"},"Setting the segment config to ",(0,r.kt)("inlineCode",{parentName:"li"},"fetchCache = 'only-cache', dynamicParams = false"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"dynamic = 'error'")," changes the default of ",(0,r.kt)("inlineCode",{parentName:"li"},"dynamicParams")," from ",(0,r.kt)("inlineCode",{parentName:"li"},"true")," to ",(0,r.kt)("inlineCode",{parentName:"li"},"false"),". You can opt back into dynamically rendering pages for dynamic params not generated by ",(0,r.kt)("inlineCode",{parentName:"li"},"generateStaticParams")," by manually setting ",(0,r.kt)("inlineCode",{parentName:"li"},"dynamicParams = true"),"."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"'force-static'")),": Force static rendering and cache the data of a layout or page by forcing ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/cookies"},(0,r.kt)("inlineCode",{parentName:"a"},"cookies()")),", ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/headers"},(0,r.kt)("inlineCode",{parentName:"a"},"headers()"))," and ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/use-search-params"},(0,r.kt)("inlineCode",{parentName:"a"},"useSearchParams()"))," to return empty values."))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"Instructions on ",(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/upgrading/app-router-migration#step-6-migrating-data-fetching-methods"},"how to migrate")," from ",(0,r.kt)("inlineCode",{parentName:"li"},"getServerSideProps")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"getStaticProps")," to ",(0,r.kt)("inlineCode",{parentName:"li"},"dynamic: 'force-dynamic'")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"dynamic: 'error'")," can be found in the ",(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/upgrading/app-router-migration#step-6-migrating-data-fetching-methods"},"upgrade guide"),"."))),(0,r.kt)("h3",{id:"dynamicparams"},(0,r.kt)("inlineCode",{parentName:"h3"},"dynamicParams")),(0,r.kt)("p",null,"Control what happens when a dynamic segment is visited that was not generated with ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/generate-static-params"},"generateStaticParams"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="layout.tsx | page.tsx" switcher',filename:'"layout.tsx',"|":!0,'page.tsx"':!0,switcher:!0},"export const dynamicParams = true // true | false,\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="layout.js | page.js | route.js" switcher',filename:'"layout.js',"|":!0,"page.js":!0,'route.js"':!0,switcher:!0},"export const dynamicParams = true // true | false,\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"true"))," (default): Dynamic segments not included in ",(0,r.kt)("inlineCode",{parentName:"li"},"generateStaticParams")," are generated on demand."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"false")),": Dynamic segments not included in ",(0,r.kt)("inlineCode",{parentName:"li"},"generateStaticParams")," will return a 404.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"This option replaces the ",(0,r.kt)("inlineCode",{parentName:"li"},"fallback: true | false | blocking")," option of ",(0,r.kt)("inlineCode",{parentName:"li"},"getStaticPaths")," in the ",(0,r.kt)("inlineCode",{parentName:"li"},"pages")," directory."),(0,r.kt)("li",{parentName:"ul"},"When ",(0,r.kt)("inlineCode",{parentName:"li"},"dynamicParams = true"),", the segment uses ",(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing/loading-ui-and-streaming#streaming-with-suspense"},"Streaming Server Rendering"),"."),(0,r.kt)("li",{parentName:"ul"},"If the ",(0,r.kt)("inlineCode",{parentName:"li"},"dynamic = 'error'")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"dynamic = 'force-static'")," are used, it'll change the default of ",(0,r.kt)("inlineCode",{parentName:"li"},"dynamicParams")," to ",(0,r.kt)("inlineCode",{parentName:"li"},"false"),"."))),(0,r.kt)("h3",{id:"revalidate"},(0,r.kt)("inlineCode",{parentName:"h3"},"revalidate")),(0,r.kt)("p",null,"Set the default revalidation time for a layout or page. This option does not override the ",(0,r.kt)("inlineCode",{parentName:"p"},"revalidate")," value set by individual ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," requests."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="layout.tsx | page.tsx | route.ts" switcher',filename:'"layout.tsx',"|":!0,"page.tsx":!0,'route.ts"':!0,switcher:!0},"export const revalidate = false\n// false | 'force-cache' | 0 | number\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="layout.js | page.js | route.js" switcher',filename:'"layout.js',"|":!0,"page.js":!0,'route.js"':!0,switcher:!0},"export const revalidate = false\n// false | 'force-cache' | 0 | number\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"false")),": (default) The default heuristic to cache any ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests that set their ",(0,r.kt)("inlineCode",{parentName:"li"},"cache")," option to ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-cache'")," or are discovered before a ",(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/rendering/server-components#server-rendering-strategies#dynamic-functions"},"dynamic function")," is used. Semantically equivalent to ",(0,r.kt)("inlineCode",{parentName:"li"},"revalidate: Infinity")," which effectively means the resource should be cached indefinitely. It is still possible for individual ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests to use ",(0,r.kt)("inlineCode",{parentName:"li"},"cache: 'no-store'")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"revalidate: 0")," to avoid being cached and make the route dynamically rendered. Or set ",(0,r.kt)("inlineCode",{parentName:"li"},"revalidate")," to a positive number lower than the route default to increase the revalidation frequency of a route."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"0")),": Ensure a layout or page is always ",(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/rendering/server-components#dynamic-rendering"},"dynamically rendered")," even if no dynamic functions or uncached data fetches are discovered. This option changes the default of ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests that do not set a ",(0,r.kt)("inlineCode",{parentName:"li"},"cache")," option to ",(0,r.kt)("inlineCode",{parentName:"li"},"'no-store'")," but leaves ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests that opt into ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-cache'")," or use a positive ",(0,r.kt)("inlineCode",{parentName:"li"},"revalidate")," as is."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"number")),": (in seconds) Set the default revalidation frequency of a layout or page to ",(0,r.kt)("inlineCode",{parentName:"li"},"n")," seconds.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know"),": The ",(0,r.kt)("inlineCode",{parentName:"p"},"revalidate")," option is only available when using the ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/rendering/edge-and-nodejs-runtimes#nodejs-runtime"},"Node.js Runtime"),". This means using the ",(0,r.kt)("inlineCode",{parentName:"p"},"revalidate")," option with ",(0,r.kt)("inlineCode",{parentName:"p"},"runtime = 'edge'")," will not work.")),(0,r.kt)("h4",{id:"revalidation-frequency"},"Revalidation Frequency"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The lowest ",(0,r.kt)("inlineCode",{parentName:"li"},"revalidate")," across each layout and page of a single route will determine the revalidation frequency of the ",(0,r.kt)("em",{parentName:"li"},"entire")," route. This ensures that child pages are revalidated as frequently as their parent layouts."),(0,r.kt)("li",{parentName:"ul"},"Individual ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests can set a lower ",(0,r.kt)("inlineCode",{parentName:"li"},"revalidate")," than the route's default ",(0,r.kt)("inlineCode",{parentName:"li"},"revalidate")," to increase the revalidation frequency of the entire route. This allows you to dynamically opt-in to more frequent revalidation for certain routes based on some criteria.")),(0,r.kt)("h3",{id:"fetchcache"},(0,r.kt)("inlineCode",{parentName:"h3"},"fetchCache")),(0,r.kt)("details",null,(0,r.kt)("summary",null,"This is an advanced option that should only be used if you specifically need to override the default behavior."),(0,r.kt)("p",null,"By default, Next.js ",(0,r.kt)("strong",{parentName:"p"},"will cache")," any ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch()")," requests that are reachable ",(0,r.kt)("strong",{parentName:"p"},"before")," any ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/rendering/server-components#server-rendering-strategies#dynamic-functions"},"dynamic functions")," are used and ",(0,r.kt)("strong",{parentName:"p"},"will not cache")," ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," requests that are discovered ",(0,r.kt)("strong",{parentName:"p"},"after")," dynamic functions are used."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"fetchCache")," allows you to override the default ",(0,r.kt)("inlineCode",{parentName:"p"},"cache")," option of all ",(0,r.kt)("inlineCode",{parentName:"p"},"fetch")," requests in a layout or page."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="layout.tsx | page.tsx | route.ts" switcher',filename:'"layout.tsx',"|":!0,"page.tsx":!0,'route.ts"':!0,switcher:!0},"export const fetchCache = 'auto'\n// 'auto' | 'default-cache' | 'only-cache'\n// 'force-cache' | 'force-no-store' | 'default-no-store' | 'only-no-store'\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="layout.js | page.js | route.js" switcher',filename:'"layout.js',"|":!0,"page.js":!0,'route.js"':!0,switcher:!0},"export const fetchCache = 'auto'\n// 'auto' | 'default-cache' | 'only-cache'\n// 'force-cache' | 'force-no-store' | 'default-no-store' | 'only-no-store'\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"'auto'"))," (default)- The default option to cache ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests before dynamic functions with the ",(0,r.kt)("inlineCode",{parentName:"li"},"cache")," option they provide and not cache ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests after dynamic functions."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"'default-cache'")),": Allow any ",(0,r.kt)("inlineCode",{parentName:"li"},"cache")," option to be passed to ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," but if no option is provided then set the ",(0,r.kt)("inlineCode",{parentName:"li"},"cache")," option to ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-cache'"),". This means that even ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests after dynamic functions are considered static."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"'only-cache'")),": Ensure all ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests opt into caching by changing the default to ",(0,r.kt)("inlineCode",{parentName:"li"},"cache: 'force-cache'")," if no option is provided and causing an error if any ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests use ",(0,r.kt)("inlineCode",{parentName:"li"},"cache: 'no-store'"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"'force-cache'")),": Ensure all ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests opt into caching by setting the ",(0,r.kt)("inlineCode",{parentName:"li"},"cache")," option of all ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests to ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-cache'"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"'default-no-store'")),": Allow any ",(0,r.kt)("inlineCode",{parentName:"li"},"cache")," option to be passed to ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," but if no option is provided then set the ",(0,r.kt)("inlineCode",{parentName:"li"},"cache")," option to ",(0,r.kt)("inlineCode",{parentName:"li"},"'no-store'"),". This means that even ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests before dynamic functions are considered dynamic."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"'only-no-store'")),": Ensure all ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests opt out of caching by changing the default to ",(0,r.kt)("inlineCode",{parentName:"li"},"cache: 'no-store'")," if no option is provided and causing an error if any ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests use ",(0,r.kt)("inlineCode",{parentName:"li"},"cache: 'force-cache'")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"'force-no-store'")),": Ensure all ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests opt out of caching by setting the ",(0,r.kt)("inlineCode",{parentName:"li"},"cache")," option of all ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests to ",(0,r.kt)("inlineCode",{parentName:"li"},"'no-store'"),". This forces all ",(0,r.kt)("inlineCode",{parentName:"li"},"fetch")," requests to be re-fetched every request even if they provide a ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-cache'")," option.")),(0,r.kt)("h4",{id:"cross-route-segment-behavior"},"Cross-route segment behavior"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Any options set across each layout and page of a single route need to be compatible with each other.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"If both the ",(0,r.kt)("inlineCode",{parentName:"li"},"'only-cache'")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-cache'")," are provided, then ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-cache'")," wins. If both ",(0,r.kt)("inlineCode",{parentName:"li"},"'only-no-store'")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-no-store'")," are provided, then ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-no-store'")," wins. The force option changes the behavior across the route so a single segment with ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-*'")," would prevent any errors caused by ",(0,r.kt)("inlineCode",{parentName:"li"},"'only-*'"),"."),(0,r.kt)("li",{parentName:"ul"},"The intention of the ",(0,r.kt)("inlineCode",{parentName:"li"},"'only-*'")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"force-*'")," options is to guarantee the whole route is either fully static or fully dynamic. This means:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"A combination of ",(0,r.kt)("inlineCode",{parentName:"li"},"'only-cache'")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"'only-no-store'")," in a single route is not allowed."),(0,r.kt)("li",{parentName:"ul"},"A combination of ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-cache'")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"'force-no-store'")," in a single route is not allowed."))),(0,r.kt)("li",{parentName:"ul"},"A parent cannot provide ",(0,r.kt)("inlineCode",{parentName:"li"},"'default-no-store'")," if a child provides ",(0,r.kt)("inlineCode",{parentName:"li"},"'auto'")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"'*-cache'")," since that could make the same fetch have different behavior."))),(0,r.kt)("li",{parentName:"ul"},"It is generally recommended to leave shared parent layouts as ",(0,r.kt)("inlineCode",{parentName:"li"},"'auto'")," and customize the options where child segments diverge."))),(0,r.kt)("h3",{id:"runtime"},(0,r.kt)("inlineCode",{parentName:"h3"},"runtime")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="layout.tsx | page.tsx | route.ts" switcher',filename:'"layout.tsx',"|":!0,"page.tsx":!0,'route.ts"':!0,switcher:!0},"export const runtime = 'nodejs'\n// 'edge' | 'nodejs'\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="layout.js | page.js | route.js" switcher',filename:'"layout.js',"|":!0,"page.js":!0,'route.js"':!0,switcher:!0},"export const runtime = 'nodejs'\n// 'edge' | 'nodejs'\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"nodejs"))," (default)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"edge")))),(0,r.kt)("p",null,"Learn more about the ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/rendering/edge-and-nodejs-runtimes"},"Edge and Node.js runtimes"),"."),(0,r.kt)("h3",{id:"preferredregion"},(0,r.kt)("inlineCode",{parentName:"h3"},"preferredRegion")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="layout.tsx | page.tsx | route.ts" switcher',filename:'"layout.tsx',"|":!0,"page.tsx":!0,'route.ts"':!0,switcher:!0},"export const preferredRegion = 'auto'\n// 'auto' | 'global' | 'home' | ['iad1', 'sfo1']\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="layout.js | page.js | route.js" switcher',filename:'"layout.js',"|":!0,"page.js":!0,'route.js"':!0,switcher:!0},"export const preferredRegion = 'auto'\n// 'auto' | 'global' | 'home' | ['iad1', 'sfo1']\n")),(0,r.kt)("p",null,"Support for ",(0,r.kt)("inlineCode",{parentName:"p"},"preferredRegion"),", and regions supported, is dependent on your deployment platform."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"If a ",(0,r.kt)("inlineCode",{parentName:"li"},"preferredRegion")," is not specified, it will inherit the option of the nearest parent layout."),(0,r.kt)("li",{parentName:"ul"},"The root layout defaults to ",(0,r.kt)("inlineCode",{parentName:"li"},"all")," regions."))),(0,r.kt)("h3",{id:"maxduration"},(0,r.kt)("inlineCode",{parentName:"h3"},"maxDuration")),(0,r.kt)("p",null,"Based on your deployment platform, you may be able to use a higher default execution time for your function.\nThis setting allows you to opt into a higher execution time within your plans limit.\n",(0,r.kt)("strong",{parentName:"p"},"Note"),": This settings requires Next.js ",(0,r.kt)("inlineCode",{parentName:"p"},"13.4.10")," or higher."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="layout.tsx | page.tsx | route.ts" switcher',filename:'"layout.tsx',"|":!0,"page.tsx":!0,'route.ts"':!0,switcher:!0},"export const maxDuration = 5\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="layout.js | page.js | route.js" switcher',filename:'"layout.js',"|":!0,"page.js":!0,'route.js"':!0,switcher:!0},"export const maxDuration = 5\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know"),":"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"If a ",(0,r.kt)("inlineCode",{parentName:"li"},"maxDuration")," is not specified, the default value is dependent on your deployment platform and plan."))),(0,r.kt)("h3",{id:"generatestaticparams"},(0,r.kt)("inlineCode",{parentName:"h3"},"generateStaticParams")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"generateStaticParams")," function can be used in combination with ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/dynamic-routes"},"dynamic route segments")," to define the list of route segment parameters that will be statically generated at build time instead of on-demand at request time."),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/generate-static-params"},"API reference")," for more details."))}m.isMDXComponent=!0}}]);