"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[5281],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(a),d=i,h=u["".concat(p,".").concat(d)]||u[d]||m[d]||r;return a?n.createElement(h,o(o({ref:t},c),{},{components:a})):n.createElement(h,o({ref:t},c))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:i,o[1]=l;for(var s=2;s<r;s++)o[s]=a[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},2991:(e,t,a)=>{a.d(t,{Z:()=>g});var n=a(7294),i=a(6010),r=a(2802),o=a(9960),l=a(3919),p=a(5999);const s={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};function c(e){let{href:t,children:a}=e;return n.createElement(o.Z,{href:t,className:(0,i.Z)("card padding--lg",s.cardContainer)},a)}function u(e){let{href:t,icon:a,title:r,description:o}=e;return n.createElement(c,{href:t},n.createElement("h2",{className:(0,i.Z)("text--truncate",s.cardTitle),title:r},a," ",r),o&&n.createElement("p",{className:(0,i.Z)("text--truncate",s.cardDescription),title:o},o))}function m(e){let{item:t}=e;const a=(0,r.Wl)(t);return a?n.createElement(u,{href:a,icon:"\ud83d\uddc3\ufe0f",title:t.label,description:t.description??(0,p.I)({message:"{count} items",id:"theme.docs.DocCard.categoryDescription",description:"The default description for a category card in the generated index about how many items this category includes"},{count:t.items.length})}):null}function d(e){let{item:t}=e;const a=(0,l.Z)(t.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",i=(0,r.xz)(t.docId??void 0);return n.createElement(u,{href:t.href,icon:a,title:t.label,description:t.description??i?.description})}function h(e){let{item:t}=e;switch(t.type){case"link":return n.createElement(d,{item:t});case"category":return n.createElement(m,{item:t});default:throw new Error(`unknown item type ${JSON.stringify(t)}`)}}function k(e){let{className:t}=e;const a=(0,r.jA)();return n.createElement(g,{items:a.items,className:t})}function g(e){const{items:t,className:a}=e;if(!t)return n.createElement(k,e);const o=(0,r.MN)(t);return n.createElement("section",{className:(0,i.Z)("row",a)},o.map(((e,t)=>n.createElement("article",{key:t,className:"col col--6 margin-bottom--lg"},n.createElement(h,{item:e})))))}},4030:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>p,toc:()=>c});var n=a(7462),i=(a(7294),a(3905)),r=a(2991);const o={title:"Deploying",description:"Learn how to deploy your Next.js app to production, either managed or self-hosted."},l=void 0,p={unversionedId:"app/building-your-application/deploying/index",id:"app/building-your-application/deploying/index",title:"Deploying",description:"Learn how to deploy your Next.js app to production, either managed or self-hosted.",source:"@site/docs/02-app/01-building-your-application/08-deploying/index.mdx",sourceDirName:"02-app/01-building-your-application/08-deploying",slug:"/app/building-your-application/deploying/",permalink:"/docs/app/building-your-application/deploying/",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-app/01-building-your-application/08-deploying/index.mdx",tags:[],version:"current",frontMatter:{title:"Deploying",description:"Learn how to deploy your Next.js app to production, either managed or self-hosted."},sidebar:"tutorialSidebar",previous:{title:"Content Security Policy",permalink:"/docs/app/building-your-application/configuring/content-security-policy"},next:{title:"Static Exports",permalink:"/docs/app/building-your-application/deploying/static-exports"}},s={},c=[{value:"Next.js Build API",id:"nextjs-build-api",level:2},{value:"Managed Next.js with Vercel",id:"managed-nextjs-with-vercel",level:2},{value:"Self-Hosting",id:"self-hosting",level:2},{value:"Node.js Server",id:"nodejs-server",level:3},{value:"Docker Image",id:"docker-image",level:3},{value:"Static HTML Export",id:"static-html-export",level:3},{value:"Other Services",id:"other-services",level:2},{value:"Managed Server",id:"managed-server",level:3},{value:"Static Only",id:"static-only",level:3},{value:"Serverless",id:"serverless",level:3},{value:"Automatic Updates",id:"automatic-updates",level:2},{value:"Manual Graceful shutdowns",id:"manual-graceful-shutdowns",level:2}],u={toc:c},m="wrapper";function d(e){let{components:t,...a}=e;return(0,i.kt)(m,(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Congratulations! You're here because you are ready to deploy your Next.js application. This page will show how to deploy either managed or self-hosted using the ",(0,i.kt)("a",{parentName:"p",href:"#nextjs-build-api"},"Next.js Build API"),"."),(0,i.kt)("h2",{id:"nextjs-build-api"},"Next.js Build API"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"next build")," generates an optimized version of your application for production. This standard output includes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"HTML files for pages using ",(0,i.kt)("inlineCode",{parentName:"li"},"getStaticProps")," or ",(0,i.kt)("a",{parentName:"li",href:"/docs/pages/building-your-application/rendering/automatic-static-optimization"},"Automatic Static Optimization")),(0,i.kt)("li",{parentName:"ul"},"CSS files for global styles or for individually scoped styles"),(0,i.kt)("li",{parentName:"ul"},"JavaScript for pre-rendering dynamic content from the Next.js server"),(0,i.kt)("li",{parentName:"ul"},"JavaScript for interactivity on the client-side through React")),(0,i.kt)("p",null,"This output is generated inside the ",(0,i.kt)("inlineCode",{parentName:"p"},".next")," folder:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".next/static/chunks/pages")," \u2013 Each JavaScript file inside this folder relates to the route with the same name. For example, ",(0,i.kt)("inlineCode",{parentName:"li"},".next/static/chunks/pages/about.js")," would be the JavaScript file loaded when viewing the ",(0,i.kt)("inlineCode",{parentName:"li"},"/about")," route in your application"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".next/static/media")," \u2013 Statically imported images from ",(0,i.kt)("inlineCode",{parentName:"li"},"next/image")," are hashed and copied here"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".next/static/css")," \u2013 Global CSS files for all pages in your application"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".next/server/pages")," \u2013 The HTML and JavaScript entry points prerendered from the server. The ",(0,i.kt)("inlineCode",{parentName:"li"},".nft.json")," files are created when ",(0,i.kt)("a",{parentName:"li",href:"/docs/pages/api-reference/next-config-js/output"},"Output File Tracing")," is enabled and contain all the file paths that depend on a given page."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".next/server/chunks")," \u2013 Shared JavaScript chunks used in multiple places throughout your application"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".next/cache")," \u2013 Output for the build cache and cached images, responses, and pages from the Next.js server. Using a cache helps decrease build times and improve performance of loading images")),(0,i.kt)("p",null,"All JavaScript code inside ",(0,i.kt)("inlineCode",{parentName:"p"},".next")," has been ",(0,i.kt)("strong",{parentName:"p"},"compiled")," and browser bundles have been ",(0,i.kt)("strong",{parentName:"p"},"minified")," to help achieve the best performance and support ",(0,i.kt)("a",{parentName:"p",href:"/docs/architecture/supported-browsers"},"all modern browsers"),"."),(0,i.kt)("h2",{id:"managed-nextjs-with-vercel"},"Managed Next.js with Vercel"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://vercel.com?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Vercel")," is the fastest way to deploy your Next.js application with zero configuration."),(0,i.kt)("p",null,"When deploying to Vercel, the platform ",(0,i.kt)("a",{parentName:"p",href:"https://vercel.com/solutions/nextjs?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"automatically detects Next.js"),", runs ",(0,i.kt)("inlineCode",{parentName:"p"},"next build"),", and optimizes the build output for you, including:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Persisting cached assets across deployments if unchanged"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://vercel.com/features/previews?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Immutable deployments")," with a unique URL for every commit"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/pages/building-your-application/rendering/automatic-static-optimization"},"Pages")," are automatically statically optimized, if possible"),(0,i.kt)("li",{parentName:"ul"},"Assets (JavaScript, CSS, images, fonts) are compressed and served from a ",(0,i.kt)("a",{parentName:"li",href:"https://vercel.com/features/infrastructure?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Global Edge Network")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/pages/building-your-application/routing/api-routes"},"API Routes")," are automatically optimized as isolated ",(0,i.kt)("a",{parentName:"li",href:"https://vercel.com/features/infrastructure?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Serverless Functions")," that can scale infinitely"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/pages/building-your-application/routing/middleware"},"Middleware")," is automatically optimized as ",(0,i.kt)("a",{parentName:"li",href:"https://vercel.com/features/edge-functions?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Edge Functions")," that have zero cold starts and boot instantly")),(0,i.kt)("p",null,"In addition, Vercel provides features like:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Automatic performance monitoring with ",(0,i.kt)("a",{parentName:"li",href:"https://vercel.com/analytics?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Next.js Speed Insights")),(0,i.kt)("li",{parentName:"ul"},"Automatic HTTPS and SSL certificates"),(0,i.kt)("li",{parentName:"ul"},"Automatic CI/CD (through GitHub, GitLab, Bitbucket, etc.)"),(0,i.kt)("li",{parentName:"ul"},"Support for ",(0,i.kt)("a",{parentName:"li",href:"https://vercel.com/docs/environment-variables?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Environment Variables")),(0,i.kt)("li",{parentName:"ul"},"Support for ",(0,i.kt)("a",{parentName:"li",href:"https://vercel.com/docs/custom-domains?utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Custom Domains")),(0,i.kt)("li",{parentName:"ul"},"Support for ",(0,i.kt)("a",{parentName:"li",href:"/docs/pages/building-your-application/optimizing/images"},"Image Optimization")," with ",(0,i.kt)("inlineCode",{parentName:"li"},"next/image")),(0,i.kt)("li",{parentName:"ul"},"Instant global deployments via ",(0,i.kt)("inlineCode",{parentName:"li"},"git push"))),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://vercel.com/new/git/external?repository-url=https://github.com/vercel/next.js/tree/canary/examples/hello-world&project-name=hello-world&repository-name=hello-world&utm_source=next-site&utm_medium=docs&utm_campaign=next-website"},"Deploy a Next.js application to Vercel")," for free to try it out."),(0,i.kt)("h2",{id:"self-hosting"},"Self-Hosting"),(0,i.kt)("p",null,"You can self-host Next.js with support for all features using Node.js or Docker. You can also do a Static HTML Export, which ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/deploying/static-exports"},"has some limitations"),"."),(0,i.kt)("h3",{id:"nodejs-server"},"Node.js Server"),(0,i.kt)("p",null,"Next.js can be deployed to any hosting provider that supports Node.js. For example, ",(0,i.kt)("a",{parentName:"p",href:"https://aws.amazon.com/ec2/"},"AWS EC2")," or a ",(0,i.kt)("a",{parentName:"p",href:"https://www.digitalocean.com/products/droplets/"},"DigitalOcean Droplet"),"."),(0,i.kt)("p",null,"First, ensure your ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json")," has the ",(0,i.kt)("inlineCode",{parentName:"p"},'"build"')," and ",(0,i.kt)("inlineCode",{parentName:"p"},'"start"')," scripts:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'filename="package.json"',filename:'"package.json"'},'{\n    "scripts": {\n        "dev": "next dev",\n        "build": "next build",\n        "start": "next start"\n    }\n}\n')),(0,i.kt)("p",null,"Then, run ",(0,i.kt)("inlineCode",{parentName:"p"},"npm run build")," to build your application. Finally, run ",(0,i.kt)("inlineCode",{parentName:"p"},"npm run start")," to start the Node.js server. This server supports all features of Next.js."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"If you are using ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/building-your-application/optimizing/images"},(0,i.kt)("inlineCode",{parentName:"a"},"next/image")),", consider adding ",(0,i.kt)("inlineCode",{parentName:"p"},"sharp")," for more performant ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/building-your-application/optimizing/images"},"Image Optimization")," in your production environment by running ",(0,i.kt)("inlineCode",{parentName:"p"},"npm install sharp")," in your project directory. On Linux platforms, ",(0,i.kt)("inlineCode",{parentName:"p"},"sharp")," may require ",(0,i.kt)("a",{parentName:"p",href:"https://sharp.pixelplumbing.com/install#linux-memory-allocator"},"additional configuration")," to prevent excessive memory usage.")),(0,i.kt)("h3",{id:"docker-image"},"Docker Image"),(0,i.kt)("p",null,"Next.js can be deployed to any hosting provider that supports ",(0,i.kt)("a",{parentName:"p",href:"https://www.docker.com/"},"Docker")," containers. You can use this approach when deploying to container orchestrators such as ",(0,i.kt)("a",{parentName:"p",href:"https://kubernetes.io/"},"Kubernetes")," or ",(0,i.kt)("a",{parentName:"p",href:"https://www.nomadproject.io/"},"HashiCorp Nomad"),", or when running inside a single node in any cloud provider."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://docs.docker.com/get-docker/"},"Install Docker")," on your machine"),(0,i.kt)("li",{parentName:"ol"},"Clone the ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/tree/canary/examples/with-docker"},"with-docker")," example"),(0,i.kt)("li",{parentName:"ol"},"Build your container: ",(0,i.kt)("inlineCode",{parentName:"li"},"docker build -t nextjs-docker .")),(0,i.kt)("li",{parentName:"ol"},"Run your container: ",(0,i.kt)("inlineCode",{parentName:"li"},"docker run -p 3000:3000 nextjs-docker"))),(0,i.kt)("p",null,"If you need to use different Environment Variables across multiple environments, check out our ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/vercel/next.js/tree/canary/examples/with-docker-multi-env"},"with-docker-multi-env")," example."),(0,i.kt)("h3",{id:"static-html-export"},"Static HTML Export"),(0,i.kt)("p",null,"If you\u2019d like to do a static HTML export of your Next.js app, follow the directions on our ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/deploying/static-exports"},"Static HTML Export documentation"),"."),(0,i.kt)("h2",{id:"other-services"},"Other Services"),(0,i.kt)("p",null,"The following services support Next.js ",(0,i.kt)("inlineCode",{parentName:"p"},"v12+"),". Below, you\u2019ll find examples or guides to deploy Next.js to each service."),(0,i.kt)("h3",{id:"managed-server"},"Managed Server"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://aws.github.io/copilot-cli/"},"AWS Copilot")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.digitalocean.com/tutorials/app-nextjs-deploy/"},"Digital Ocean App Platform")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/tree/canary/examples/with-docker"},"Google Cloud Run")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://elements.heroku.com/buildpacks/mars/heroku-nextjs"},"Heroku")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.railway.app/getting-started"},"Railway")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://render.com/docs/deploy-nextjs-app"},"Render"))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": There are also managed platforms that allow you to use a Dockerfile as shown in the ",(0,i.kt)("a",{parentName:"p",href:"#docker-image"},"example above"),".")),(0,i.kt)("h3",{id:"static-only"},"Static Only"),(0,i.kt)("p",null,"The following services only support deploying Next.js using ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/deploying/static-exports"},(0,i.kt)("inlineCode",{parentName:"a"},"output: 'export'")),"."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/tree/canary/examples/github-pages"},"GitHub Pages"))),(0,i.kt)("p",null,"You can also manually deploy the output from ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/deploying/static-exports"},(0,i.kt)("inlineCode",{parentName:"a"},"output: 'export'"))," to any static hosting provider, often through your CI/CD pipeline like GitHub Actions, Jenkins, AWS CodeBuild, Circle CI, Azure Pipelines, and more."),(0,i.kt)("h3",{id:"serverless"},"Serverless"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://aws.amazon.com/blogs/mobile/amplify-next-js-13/"},"AWS Amplify")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/azure/static-web-apps/nextjs"},"Azure Static Web Apps")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://developers.cloudflare.com/pages/framework-guides/deploy-a-nextjs-site/"},"Cloudflare Pages")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://firebase.google.com/docs/hosting/nextjs"},"Firebase")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.netlify.com/integrations/frameworks/next-js"},"Netlify")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/milliHQ/terraform-aws-next-js"},"Terraform")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.sst.dev/start/nextjs"},"SST"))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": Not all serverless providers implement the ",(0,i.kt)("a",{parentName:"p",href:"#nextjs-build-api"},"Next.js Build API")," from ",(0,i.kt)("inlineCode",{parentName:"p"},"next start"),". Please check with the provider to see what features are supported.")),(0,i.kt)("h2",{id:"automatic-updates"},"Automatic Updates"),(0,i.kt)("p",null,"When you deploy your Next.js application, you want to see the latest version without needing to reload."),(0,i.kt)("p",null,"Next.js will automatically load the latest version of your application in the background when routing. For client-side navigations, ",(0,i.kt)("inlineCode",{parentName:"p"},"next/link")," will temporarily function as a normal ",(0,i.kt)("inlineCode",{parentName:"p"},"<a>")," tag."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": If a new page (with an old version) has already been prefetched by ",(0,i.kt)("inlineCode",{parentName:"p"},"next/link"),", Next.js will use the old version. Navigating to a page that has ",(0,i.kt)("em",{parentName:"p"},"not")," been prefetched (and is not cached at the CDN level) will load the latest version.")),(0,i.kt)("h2",{id:"manual-graceful-shutdowns"},"Manual Graceful shutdowns"),(0,i.kt)("p",null,"When self-hosting, you might want to run code when the server shuts down on ",(0,i.kt)("inlineCode",{parentName:"p"},"SIGTERM")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"SIGINT")," signals."),(0,i.kt)("p",null,"You can set the env variable ",(0,i.kt)("inlineCode",{parentName:"p"},"NEXT_MANUAL_SIG_HANDLE")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," and then register a handler for that signal inside your ",(0,i.kt)("inlineCode",{parentName:"p"},"_document.js")," file. You will need to register the env variable directly in the ",(0,i.kt)("inlineCode",{parentName:"p"},"package.json")," script, not in the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": Manual signal handling is not available in ",(0,i.kt)("inlineCode",{parentName:"p"},"next dev"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'filename="package.json"',filename:'"package.json"'},'{\n    "scripts": {\n        "dev": "next dev",\n        "build": "next build",\n        "start": "NEXT_MANUAL_SIG_HANDLE=true next start"\n    }\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="pages/_document.js"',filename:'"pages/_document.js"'},'if (process.env.NEXT_MANUAL_SIG_HANDLE) {\n    // this should be added in your custom _document\n    process.on("SIGTERM", () => {\n        console.log("Received SIGTERM: ", "cleaning up");\n        process.exit(0);\n    });\n\n    process.on("SIGINT", () => {\n        console.log("Received SIGINT: ", "cleaning up");\n        process.exit(0);\n    });\n}\n')),(0,i.kt)(r.Z,{mdxType:"DocCardList"}))}d.isMDXComponent=!0}}]);