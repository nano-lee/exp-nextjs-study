"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[8607],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=s(n),d=r,k=m["".concat(p,".").concat(d)]||m[d]||c[d]||i;return n?a.createElement(k,o(o({ref:t},u),{},{components:n})):a.createElement(k,o({ref:t},u))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[m]="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7755:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));const i={sidebar_position:8,title:"OpenTelemetry",description:"Learn how to instrument your Next.js app with OpenTelemetry."},o=void 0,l={unversionedId:"app/building-your-application/optimizing/open-telemetry",id:"app/building-your-application/optimizing/open-telemetry",title:"OpenTelemetry",description:"Learn how to instrument your Next.js app with OpenTelemetry.",source:"@site/docs/02-app/01-building-your-application/06-optimizing/08-open-telemetry.mdx",sourceDirName:"02-app/01-building-your-application/06-optimizing",slug:"/app/building-your-application/optimizing/open-telemetry",permalink:"/nano-nextjs-study/docs/app/building-your-application/optimizing/open-telemetry",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-app/01-building-your-application/06-optimizing/08-open-telemetry.mdx",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8,title:"OpenTelemetry",description:"Learn how to instrument your Next.js app with OpenTelemetry."},sidebar:"tutorialSidebar",previous:{title:"Analytics",permalink:"/nano-nextjs-study/docs/app/building-your-application/optimizing/analytics"},next:{title:"Instrumentation",permalink:"/nano-nextjs-study/docs/app/building-your-application/optimizing/instrumentation"}},p={},s=[{value:"Getting Started",id:"getting-started",level:2},{value:"Using <code>@vercel/otel</code>",id:"using-vercelotel",level:3},{value:"Manual OpenTelemetry configuration",id:"manual-opentelemetry-configuration",level:3},{value:"Testing your instrumentation",id:"testing-your-instrumentation",level:2},{value:"Deployment",id:"deployment",level:2},{value:"Using OpenTelemetry Collector",id:"using-opentelemetry-collector",level:3},{value:"Deploying on Vercel",id:"deploying-on-vercel",level:4},{value:"Self-hosting",id:"self-hosting",level:4},{value:"Custom Exporters",id:"custom-exporters",level:3},{value:"Custom Spans",id:"custom-spans",level:2},{value:"Default Spans in Next.js",id:"default-spans-in-nextjs",level:2},{value:"<code>[http.method] [next.route]</code>",id:"httpmethod-nextroute",level:3},{value:"<code>render route (app) [next.route]</code>",id:"render-route-app-nextroute",level:3},{value:"<code>fetch [http.method] [http.url]</code>",id:"fetch-httpmethod-httpurl",level:3},{value:"<code>executing api route (app) [next.route]</code>",id:"executing-api-route-app-nextroute",level:3},{value:"<code>getServerSideProps [next.route]</code>",id:"getserversideprops-nextroute",level:3},{value:"<code>getStaticProps [next.route]</code>",id:"getstaticprops-nextroute",level:3},{value:"<code>render route (pages) [next.route]</code>",id:"render-route-pages-nextroute",level:3},{value:"<code>generateMetadata [next.page]</code>",id:"generatemetadata-nextpage",level:3}],u={toc:s},m="wrapper";function c(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"{/",(0,r.kt)("em",{parentName:"p"}," The content of this doc is shared between the app and pages router. You can use the  component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. "),"/}"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know"),": This feature is ",(0,r.kt)("strong",{parentName:"p"},"experimental"),", you need to explicitly opt-in by providing ",(0,r.kt)("inlineCode",{parentName:"p"},"experimental.instrumentationHook = true;")," in your ",(0,r.kt)("inlineCode",{parentName:"p"},"next.config.js"),".")),(0,r.kt)("p",null,"Observability is crucial for understanding and optimizing the behavior and performance of your Next.js app."),(0,r.kt)("p",null,"As applications become more complex, it becomes increasingly difficult to identify and diagnose issues that may arise. By leveraging observability tools, such as logging and metrics, developers can gain insights into their application's behavior and identify areas for optimization. With observability, developers can proactively address issues before they become major problems and provide a better user experience. Therefore, it is highly recommended to use observability in your Next.js applications to improve performance, optimize resources, and enhance user experience."),(0,r.kt)("p",null,"We recommend using OpenTelemetry for instrumenting your apps.\nIt's a platform-agnostic way to instrument apps that allows you to change your observability provider without changing your code.\nRead ",(0,r.kt)("a",{parentName:"p",href:"https://opentelemetry.io/docs/"},"Official OpenTelemetry docs")," for more information about OpenTelemetry and how it works."),(0,r.kt)("p",null,"This documentation uses terms like ",(0,r.kt)("em",{parentName:"p"},"Span"),", ",(0,r.kt)("em",{parentName:"p"},"Trace")," or ",(0,r.kt)("em",{parentName:"p"},"Exporter")," throughout this doc, all of which can be found in ",(0,r.kt)("a",{parentName:"p",href:"https://opentelemetry.io/docs/concepts/observability-primer/"},"the OpenTelemetry Observability Primer"),"."),(0,r.kt)("p",null,"Next.js supports OpenTelemetry instrumentation out of the box, which means that we already instrumented Next.js itself.\nWhen you enable OpenTelemetry we will automatically wrap all your code like ",(0,r.kt)("inlineCode",{parentName:"p"},"getStaticProps")," in ",(0,r.kt)("em",{parentName:"p"},"spans")," with helpful attributes."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know"),": We currently support OpenTelemetry bindings only in serverless functions.\nWe don't provide any for ",(0,r.kt)("inlineCode",{parentName:"p"},"edge")," or client side code.")),(0,r.kt)("h2",{id:"getting-started"},"Getting Started"),(0,r.kt)("p",null,"OpenTelemetry is extensible but setting it up properly can be quite verbose.\nThat's why we prepared a package ",(0,r.kt)("inlineCode",{parentName:"p"},"@vercel/otel")," that helps you get started quickly.\nIt's not extensible and you should configure OpenTelemetry manually if you need to customize your setup."),(0,r.kt)("h3",{id:"using-vercelotel"},"Using ",(0,r.kt)("inlineCode",{parentName:"h3"},"@vercel/otel")),(0,r.kt)("p",null,"To get started, you must install ",(0,r.kt)("inlineCode",{parentName:"p"},"@vercel/otel"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npm install @vercel/otel\n")),(0,r.kt)("p",null,"Next, create a custom ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/optimizing/instrumentation"},(0,r.kt)("inlineCode",{parentName:"a"},"instrumentation.ts"))," (or ",(0,r.kt)("inlineCode",{parentName:"p"},".js"),") file in the ",(0,r.kt)("strong",{parentName:"p"},"root directory")," of the project (or inside ",(0,r.kt)("inlineCode",{parentName:"p"},"src")," folder if using one):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'filename="your-project/instrumentation.ts" switcher',filename:'"your-project/instrumentation.ts"',switcher:!0},'import { registerOTel } from "@vercel/otel";\n\nexport function register() {\n    registerOTel("next-app");\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="your-project/instrumentation.js" switcher',filename:'"your-project/instrumentation.js"',switcher:!0},'import { registerOTel } from "@vercel/otel";\n\nexport function register() {\n    registerOTel("next-app");\n}\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Good to know")),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"instrumentation")," file should be in the root of your project and not inside the ",(0,r.kt)("inlineCode",{parentName:"li"},"app")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"pages")," directory. If you're using the ",(0,r.kt)("inlineCode",{parentName:"li"},"src")," folder, then place the file inside ",(0,r.kt)("inlineCode",{parentName:"li"},"src")," alongside ",(0,r.kt)("inlineCode",{parentName:"li"},"pages")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"app"),"."),(0,r.kt)("li",{parentName:"ul"},"If you use the ",(0,r.kt)("a",{parentName:"li",href:"/docs/app/api-reference/next-config-js/pageExtensions"},(0,r.kt)("inlineCode",{parentName:"a"},"pageExtensions")," config option")," to add a suffix, you will also need to update the ",(0,r.kt)("inlineCode",{parentName:"li"},"instrumentation")," filename to match."),(0,r.kt)("li",{parentName:"ul"},"We have created a basic ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/tree/canary/examples/with-opentelemetry"},"with-opentelemetry")," example that you can use."))),(0,r.kt)("h3",{id:"manual-opentelemetry-configuration"},"Manual OpenTelemetry configuration"),(0,r.kt)("p",null,"If our wrapper ",(0,r.kt)("inlineCode",{parentName:"p"},"@vercel/otel")," doesn't suit your needs, you can configure OpenTelemetry manually."),(0,r.kt)("p",null,"Firstly you need to install OpenTelemetry packages:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npm install @opentelemetry/sdk-node @opentelemetry/resources @opentelemetry/semantic-conventions @opentelemetry/sdk-trace-node @opentelemetry/exporter-trace-otlp-http\n")),(0,r.kt)("p",null,"Now you can initialize ",(0,r.kt)("inlineCode",{parentName:"p"},"NodeSDK")," in your ",(0,r.kt)("inlineCode",{parentName:"p"},"instrumentation.ts"),".\nOpenTelemetry APIs are not compatible with edge runtime, so you need to make sure that you are importing them only when ",(0,r.kt)("inlineCode",{parentName:"p"},"process.env.NEXT_RUNTIME === 'nodejs'"),". We recommend creating a new file ",(0,r.kt)("inlineCode",{parentName:"p"},"instrumentation.node.ts")," which you conditionally import only when using node:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'filename="instrumentation.ts" switcher',filename:'"instrumentation.ts"',switcher:!0},'export async function register() {\n    if (process.env.NEXT_RUNTIME === "nodejs") {\n        await import("./instrumentation.node.ts");\n    }\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="instrumentation.js" switcher',filename:'"instrumentation.js"',switcher:!0},'export async function register() {\n    if (process.env.NEXT_RUNTIME === "nodejs") {\n        await import("./instrumentation.node.js");\n    }\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'filename="instrumentation.node.ts" switcher',filename:'"instrumentation.node.ts"',switcher:!0},'import { NodeSDK } from "@opentelemetry/sdk-node";\nimport { OTLPTraceExporter } from "@opentelemetry/exporter-trace-otlp-http";\nimport { Resource } from "@opentelemetry/resources";\nimport { SemanticResourceAttributes } from "@opentelemetry/semantic-conventions";\nimport { SimpleSpanProcessor } from "@opentelemetry/sdk-trace-node";\n\nconst sdk = new NodeSDK({\n    resource: new Resource({\n        [SemanticResourceAttributes.SERVICE_NAME]: "next-app",\n    }),\n    spanProcessor: new SimpleSpanProcessor(new OTLPTraceExporter()),\n});\nsdk.start();\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="instrumentation.node.js" switcher',filename:'"instrumentation.node.js"',switcher:!0},'import { NodeSDK } from "@opentelemetry/sdk-node";\nimport { OTLPTraceExporter } from "@opentelemetry/exporter-trace-otlp-http";\nimport { Resource } from "@opentelemetry/resources";\nimport { SemanticResourceAttributes } from "@opentelemetry/semantic-conventions";\nimport { SimpleSpanProcessor } from "@opentelemetry/sdk-trace-node";\n\nconst sdk = new NodeSDK({\n    resource: new Resource({\n        [SemanticResourceAttributes.SERVICE_NAME]: "next-app",\n    }),\n    spanProcessor: new SimpleSpanProcessor(new OTLPTraceExporter()),\n});\nsdk.start();\n')),(0,r.kt)("p",null,"Doing this is equivalent to using ",(0,r.kt)("inlineCode",{parentName:"p"},"@vercel/otel"),", but it's possible to modify and extend.\nFor example, you could use ",(0,r.kt)("inlineCode",{parentName:"p"},"@opentelemetry/exporter-trace-otlp-grpc")," instead of ",(0,r.kt)("inlineCode",{parentName:"p"},"@opentelemetry/exporter-trace-otlp-http")," or you can specify more resource attributes."),(0,r.kt)("h2",{id:"testing-your-instrumentation"},"Testing your instrumentation"),(0,r.kt)("p",null,"You need an OpenTelemetry collector with a compatible backend to test OpenTelemetry traces locally.\nWe recommend using our ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/vercel/opentelemetry-collector-dev-setup"},"OpenTelemetry dev environment"),"."),(0,r.kt)("p",null,"If everything works well you should be able to see the root server span labeled as ",(0,r.kt)("inlineCode",{parentName:"p"},"GET /requested/pathname"),".\nAll other spans from that particular trace will be nested under it."),(0,r.kt)("p",null,"Next.js traces more spans than are emitted by default.\nTo see more spans, you must set ",(0,r.kt)("inlineCode",{parentName:"p"},"NEXT_OTEL_VERBOSE=1"),"."),(0,r.kt)("h2",{id:"deployment"},"Deployment"),(0,r.kt)("h3",{id:"using-opentelemetry-collector"},"Using OpenTelemetry Collector"),(0,r.kt)("p",null,"When you are deploying with OpenTelemetry Collector, you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"@vercel/otel"),".\nIt will work both on Vercel and when self-hosted."),(0,r.kt)("h4",{id:"deploying-on-vercel"},"Deploying on Vercel"),(0,r.kt)("p",null,"We made sure that OpenTelemetry works out of the box on Vercel."),(0,r.kt)("p",null,"Follow ",(0,r.kt)("a",{parentName:"p",href:"https://vercel.com/docs/concepts/observability/otel-overview/quickstart"},"Vercel documentation")," to connect your project to an observability provider."),(0,r.kt)("h4",{id:"self-hosting"},"Self-hosting"),(0,r.kt)("p",null,"Deploying to other platforms is also straightforward. You will need to spin up your own OpenTelemetry Collector to receive and process the telemetry data from your Next.js app."),(0,r.kt)("p",null,"To do this, follow the ",(0,r.kt)("a",{parentName:"p",href:"https://opentelemetry.io/docs/collector/getting-started/"},"OpenTelemetry Collector Getting Started guide"),", which will walk you through setting up the collector and configuring it to receive data from your Next.js app."),(0,r.kt)("p",null,"Once you have your collector up and running, you can deploy your Next.js app to your chosen platform following their respective deployment guides."),(0,r.kt)("h3",{id:"custom-exporters"},"Custom Exporters"),(0,r.kt)("p",null,"We recommend using OpenTelemetry Collector.\nIf that is not possible on your platform, you can use a custom OpenTelemetry exporter with ",(0,r.kt)("a",{parentName:"p",href:"/docs/pages/building-your-application/optimizing/open-telemetry#manual-opentelemetry-configuration"},"manual OpenTelemetry configuration")),(0,r.kt)("h2",{id:"custom-spans"},"Custom Spans"),(0,r.kt)("p",null,"You can add a custom span with ",(0,r.kt)("a",{parentName:"p",href:"https://opentelemetry.io/docs/instrumentation/js/instrumentation"},"OpenTelemetry APIs"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npm install @opentelemetry/api\n")),(0,r.kt)("p",null,"The following example demonstrates a function that fetches GitHub stars and adds a custom ",(0,r.kt)("inlineCode",{parentName:"p"},"fetchGithubStars")," span to track the fetch request's result:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},'import { trace } from "@opentelemetry/api";\n\nexport async function fetchGithubStars() {\n    return await trace\n        .getTracer("nextjs-example")\n        .startActiveSpan("fetchGithubStars", async (span) => {\n            try {\n                return await getValue();\n            } finally {\n                span.end();\n            }\n        });\n}\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"register")," function will execute before your code runs in a new environment.\nYou can start creating new spans, and they should be correctly added to the exported trace."),(0,r.kt)("h2",{id:"default-spans-in-nextjs"},"Default Spans in Next.js"),(0,r.kt)("p",null,"Next.js automatically instruments several spans for you to provide useful insights into your application's performance."),(0,r.kt)("p",null,"Attributes on spans follow ",(0,r.kt)("a",{parentName:"p",href:"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/"},"OpenTelemetry semantic conventions"),". We also add some custom attributes under the ",(0,r.kt)("inlineCode",{parentName:"p"},"next")," namespace:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_name")," - duplicates span name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type")," - each span type has a unique identifier"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.route")," - The route pattern of the request (e.g., ",(0,r.kt)("inlineCode",{parentName:"li"},"/[param]/user"),")."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.page"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"This is an internal value used by an app router."),(0,r.kt)("li",{parentName:"ul"},"You can think about it as a route to a special file (like ",(0,r.kt)("inlineCode",{parentName:"li"},"page.ts"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"layout.ts"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"loading.ts")," and others)"),(0,r.kt)("li",{parentName:"ul"},"It can be used as a unique identifier only when paired with ",(0,r.kt)("inlineCode",{parentName:"li"},"next.route")," because ",(0,r.kt)("inlineCode",{parentName:"li"},"/layout")," can be used to identify both ",(0,r.kt)("inlineCode",{parentName:"li"},"/(groupA)/layout.ts")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"/(groupB)/layout.ts"))))),(0,r.kt)("h3",{id:"httpmethod-nextroute"},(0,r.kt)("inlineCode",{parentName:"h3"},"[http.method] [next.route]")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"BaseServer.handleRequest"))),(0,r.kt)("p",null,"This span represents the root span for each incoming request to your Next.js application. It tracks the HTTP method, route, target, and status code of the request."),(0,r.kt)("p",null,"Attributes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#common-attributes"},"Common HTTP attributes"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"http.method")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"http.status_code")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#http-server-semantic-conventions"},"Server HTTP attributes"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"http.route")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"http.target")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.route"))),(0,r.kt)("h3",{id:"render-route-app-nextroute"},(0,r.kt)("inlineCode",{parentName:"h3"},"render route (app) [next.route]")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"AppRender.getBodyResult"),".")),(0,r.kt)("p",null,"This span represents the process of rendering a route in the app router."),(0,r.kt)("p",null,"Attributes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.route"))),(0,r.kt)("h3",{id:"fetch-httpmethod-httpurl"},(0,r.kt)("inlineCode",{parentName:"h3"},"fetch [http.method] [http.url]")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"AppRender.fetch"))),(0,r.kt)("p",null,"This span represents the fetch request executed in your code."),(0,r.kt)("p",null,"Attributes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#common-attributes"},"Common HTTP attributes"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"http.method")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/http/#http-client"},"Client HTTP attributes"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"http.url")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"net.peer.name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"net.peer.port")," (only if specified)"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type"))),(0,r.kt)("h3",{id:"executing-api-route-app-nextroute"},(0,r.kt)("inlineCode",{parentName:"h3"},"executing api route (app) [next.route]")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"AppRouteRouteHandlers.runHandler"),".")),(0,r.kt)("p",null,"This span represents the execution of an API route handler in the app router."),(0,r.kt)("p",null,"Attributes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.route"))),(0,r.kt)("h3",{id:"getserversideprops-nextroute"},(0,r.kt)("inlineCode",{parentName:"h3"},"getServerSideProps [next.route]")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"Render.getServerSideProps"),".")),(0,r.kt)("p",null,"This span represents the execution of ",(0,r.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," for a specific route."),(0,r.kt)("p",null,"Attributes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.route"))),(0,r.kt)("h3",{id:"getstaticprops-nextroute"},(0,r.kt)("inlineCode",{parentName:"h3"},"getStaticProps [next.route]")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"Render.getStaticProps"),".")),(0,r.kt)("p",null,"This span represents the execution of ",(0,r.kt)("inlineCode",{parentName:"p"},"getStaticProps")," for a specific route."),(0,r.kt)("p",null,"Attributes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.route"))),(0,r.kt)("h3",{id:"render-route-pages-nextroute"},(0,r.kt)("inlineCode",{parentName:"h3"},"render route (pages) [next.route]")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"Render.renderDocument"),".")),(0,r.kt)("p",null,"This span represents the process of rendering the document for a specific route."),(0,r.kt)("p",null,"Attributes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.route"))),(0,r.kt)("h3",{id:"generatemetadata-nextpage"},(0,r.kt)("inlineCode",{parentName:"h3"},"generateMetadata [next.page]")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"ResolveMetadata.generateMetadata"),".")),(0,r.kt)("p",null,"This span represents the process of generating metadata for a specific page (a single route can have multiple of these spans)."),(0,r.kt)("p",null,"Attributes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_name")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.span_type")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"next.page"))))}c.isMDXComponent=!0}}]);