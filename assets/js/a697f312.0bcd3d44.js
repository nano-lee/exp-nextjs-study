"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[5225],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>g});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),l=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=l(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),m=l(n),u=i,g=m["".concat(s,".").concat(u)]||m[u]||c[u]||r;return n?a.createElement(g,o(o({ref:t},d),{},{components:n})):a.createElement(g,o({ref:t},d))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=u;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p[m]="string"==typeof e?e:i,o[1]=p;for(var l=2;l<r;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6378:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>p,toc:()=>l});var a=n(7462),i=(n(7294),n(3905));const r={sidebar_position:2,title:"App Router Incremental Adoption Guide",sidebar_label:"App Router Migration",description:"Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."},o=void 0,p={unversionedId:"app/building-your-application/upgrading/app-router-migration",id:"app/building-your-application/upgrading/app-router-migration",title:"App Router Incremental Adoption Guide",description:"Learn how to upgrade your existing Next.js application from the Pages Router to the App Router.",source:"@site/docs/02-app/01-building-your-application/09-upgrading/02-app-router-migration.mdx",sourceDirName:"02-app/01-building-your-application/09-upgrading",slug:"/app/building-your-application/upgrading/app-router-migration",permalink:"/docs/app/building-your-application/upgrading/app-router-migration",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-app/01-building-your-application/09-upgrading/02-app-router-migration.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"App Router Incremental Adoption Guide",sidebar_label:"App Router Migration",description:"Learn how to upgrade your existing Next.js application from the Pages Router to the App Router."},sidebar:"tutorialSidebar",previous:{title:"Codemods",permalink:"/docs/app/building-your-application/upgrading/codemods"},next:{title:"Migrating from Vite",permalink:"/docs/app/building-your-application/upgrading/from-vite"}},s={},l=[{value:"Upgrading",id:"upgrading",level:2},{value:"Node.js Version",id:"nodejs-version",level:3},{value:"Next.js Version",id:"nextjs-version",level:3},{value:"ESLint Version",id:"eslint-version",level:3},{value:"Next Steps",id:"next-steps",level:2},{value:"Upgrading New Features",id:"upgrading-new-features",level:2},{value:"<code>&lt;Image/&gt;</code> Component",id:"image-component",level:3},{value:"<code>&lt;Link&gt;</code> Component",id:"link-component",level:3},{value:"<code>&lt;Script&gt;</code> Component",id:"script-component",level:3},{value:"Font Optimization",id:"font-optimization",level:3},{value:"Migrating from <code>pages</code> to <code>app</code>",id:"migrating-from-pages-to-app",level:2},{value:"Step 1: Creating the <code>app</code> directory",id:"step-1-creating-the-app-directory",level:3},{value:"Step 2: Creating a Root Layout",id:"step-2-creating-a-root-layout",level:3},{value:"Migrating <code>_document.js</code> and <code>_app.js</code>",id:"migrating-_documentjs-and-_appjs",level:4},{value:"Migrating the <code>getLayout()</code> pattern to Layouts (Optional)",id:"migrating-the-getlayout-pattern-to-layouts-optional",level:4},{value:"Step 3: Migrating <code>next/head</code>",id:"step-3-migrating-nexthead",level:3},{value:"Step 4: Migrating Pages",id:"step-4-migrating-pages",level:3},{value:"Step 5: Migrating Routing Hooks",id:"step-5-migrating-routing-hooks",level:3},{value:"Step 6: Migrating Data Fetching Methods",id:"step-6-migrating-data-fetching-methods",level:3},{value:"Server-side Rendering (<code>getServerSideProps</code>)",id:"server-side-rendering-getserversideprops",level:4},{value:"Accessing Request Object",id:"accessing-request-object",level:4},{value:"Static Site Generation (<code>getStaticProps</code>)",id:"static-site-generation-getstaticprops",level:4},{value:"Dynamic paths (<code>getStaticPaths</code>)",id:"dynamic-paths-getstaticpaths",level:4},{value:"Replacing <code>fallback</code>",id:"replacing-fallback",level:4},{value:"Incremental Static Regeneration (<code>getStaticProps</code> with <code>revalidate</code>)",id:"incremental-static-regeneration-getstaticprops-with-revalidate",level:4},{value:"API Routes",id:"api-routes",level:4},{value:"Step 7: Styling",id:"step-7-styling",level:3},{value:"Tailwind CSS",id:"tailwind-css",level:4},{value:"Codemods",id:"codemods",level:2}],d={toc:l},m="wrapper";function c(e){let{components:t,...n}=e;return(0,i.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This guide will help you:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#nextjs-version"},"Update your Next.js application from version 12 to version 13")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#upgrading-new-features"},"Upgrade features that work in both the ",(0,i.kt)("inlineCode",{parentName:"a"},"pages")," and the ",(0,i.kt)("inlineCode",{parentName:"a"},"app")," directories")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#migrating-from-pages-to-app"},"Incrementally migrate your existing application from ",(0,i.kt)("inlineCode",{parentName:"a"},"pages")," to ",(0,i.kt)("inlineCode",{parentName:"a"},"app")))),(0,i.kt)("h2",{id:"upgrading"},"Upgrading"),(0,i.kt)("h3",{id:"nodejs-version"},"Node.js Version"),(0,i.kt)("p",null,"The minimum Node.js version is now ",(0,i.kt)("strong",{parentName:"p"},"v18.17"),". See the ",(0,i.kt)("a",{parentName:"p",href:"https://nodejs.org/docs/latest-v18.x/api/"},"Node.js documentation")," for more information."),(0,i.kt)("h3",{id:"nextjs-version"},"Next.js Version"),(0,i.kt)("p",null,"To update to Next.js version 13, run the following command using your preferred package manager:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npm install next@latest react@latest react-dom@latest\n")),(0,i.kt)("h3",{id:"eslint-version"},"ESLint Version"),(0,i.kt)("p",null,"If you're using ESLint, you need to upgrade your ESLint version:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npm install -D eslint-config-next@latest\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": You may need to restart the ESLint server in VS Code for the ESLint changes to take effect. Open the Command Palette (",(0,i.kt)("inlineCode",{parentName:"p"},"cmd+shift+p")," on Mac; ",(0,i.kt)("inlineCode",{parentName:"p"},"ctrl+shift+p")," on Windows) and search for ",(0,i.kt)("inlineCode",{parentName:"p"},"ESLint: Restart ESLint Server"),".")),(0,i.kt)("h2",{id:"next-steps"},"Next Steps"),(0,i.kt)("p",null,"After you've updated, see the following sections for next steps:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#upgrading-new-features"},"Upgrade new features"),": A guide to help you upgrade to new features such as the improved Image and Link Components."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#migrating-from-pages-to-app"},"Migrate from the ",(0,i.kt)("inlineCode",{parentName:"a"},"pages")," to ",(0,i.kt)("inlineCode",{parentName:"a"},"app")," directory"),": A step-by-step guide to help you incrementally migrate from the ",(0,i.kt)("inlineCode",{parentName:"li"},"pages")," to the ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," directory.")),(0,i.kt)("h2",{id:"upgrading-new-features"},"Upgrading New Features"),(0,i.kt)("p",null,"Next.js 13 introduced the new ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing"},"App Router")," with new features and conventions. The new Router is available in the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory and co-exists with the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory."),(0,i.kt)("p",null,"Upgrading to Next.js 13 does ",(0,i.kt)("strong",{parentName:"p"},"not")," require using the new ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing#the-app-router"},"App Router"),". You can continue using ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," with new features that work in both directories, such as the updated ",(0,i.kt)("a",{parentName:"p",href:"#image-component"},"Image component"),", ",(0,i.kt)("a",{parentName:"p",href:"#link-component"},"Link component"),", ",(0,i.kt)("a",{parentName:"p",href:"#script-component"},"Script component"),", and ",(0,i.kt)("a",{parentName:"p",href:"#font-optimization"},"Font optimization"),"."),(0,i.kt)("h3",{id:"image-component"},(0,i.kt)("inlineCode",{parentName:"h3"},"<Image/>")," Component"),(0,i.kt)("p",null,"Next.js 12 introduced new improvements to the Image Component with a temporary import: ",(0,i.kt)("inlineCode",{parentName:"p"},"next/future/image"),". These improvements included less client-side JavaScript, easier ways to extend and style images, better accessibility, and native browser lazy loading."),(0,i.kt)("p",null,"In version 13, this new behavior is now the default for ",(0,i.kt)("inlineCode",{parentName:"p"},"next/image"),"."),(0,i.kt)("p",null,"There are two codemods to help you migrate to the new Image Component:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/upgrading/codemods#next-image-to-legacy-image"},(0,i.kt)("strong",{parentName:"a"},(0,i.kt)("inlineCode",{parentName:"strong"},"next-image-to-legacy-image")," codemod")),": Safely and automatically renames ",(0,i.kt)("inlineCode",{parentName:"li"},"next/image")," imports to ",(0,i.kt)("inlineCode",{parentName:"li"},"next/legacy/image"),". Existing components will maintain the same behavior."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/upgrading/codemods#next-image-experimental"},(0,i.kt)("strong",{parentName:"a"},(0,i.kt)("inlineCode",{parentName:"strong"},"next-image-experimental")," codemod")),": Dangerously adds inline styles and removes unused props. This will change the behavior of existing components to match the new defaults. To use this codemod, you need to run the ",(0,i.kt)("inlineCode",{parentName:"li"},"next-image-to-legacy-image")," codemod first.")),(0,i.kt)("h3",{id:"link-component"},(0,i.kt)("inlineCode",{parentName:"h3"},"<Link>")," Component"),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/linking-and-navigating#link-component"},(0,i.kt)("inlineCode",{parentName:"a"},"<Link>")," Component")," no longer requires manually adding an ",(0,i.kt)("inlineCode",{parentName:"p"},"<a>")," tag as a child. This behavior was added as an experimental option in ",(0,i.kt)("a",{parentName:"p",href:"https://nextjs.org/blog/next-12-2"},"version 12.2")," and is now the default. In Next.js 13, ",(0,i.kt)("inlineCode",{parentName:"p"},"<Link>")," always renders ",(0,i.kt)("inlineCode",{parentName:"p"},"<a>")," and allows you to forward props to the underlying tag."),(0,i.kt)("p",null,"For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx"},'import Link from \'next/link\'\n\n// Next.js 12: `<a>` has to be nested otherwise it\'s excluded\n<Link href="/about">\n  <a>About</a>\n</Link>\n\n// Next.js 13: `<Link>` always renders `<a>` under the hood\n<Link href="/about">\n  About\n</Link>\n')),(0,i.kt)("p",null,"To upgrade your links to Next.js 13, you can use the ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/upgrading/codemods#new-link"},(0,i.kt)("inlineCode",{parentName:"a"},"new-link")," codemod"),"."),(0,i.kt)("h3",{id:"script-component"},(0,i.kt)("inlineCode",{parentName:"h3"},"<Script>")," Component"),(0,i.kt)("p",null,"The behavior of ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/components/script"},(0,i.kt)("inlineCode",{parentName:"a"},"next/script"))," has been updated to support both ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"app"),", but some changes need to be made to ensure a smooth migration:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Move any ",(0,i.kt)("inlineCode",{parentName:"li"},"beforeInteractive")," scripts you previously included in ",(0,i.kt)("inlineCode",{parentName:"li"},"_document.js")," to the root layout file (",(0,i.kt)("inlineCode",{parentName:"li"},"app/layout.tsx"),")."),(0,i.kt)("li",{parentName:"ul"},"The experimental ",(0,i.kt)("inlineCode",{parentName:"li"},"worker")," strategy does not yet work in ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," and scripts denoted with this strategy will either have to be removed or modified to use a different strategy (e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},"lazyOnload"),")."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"onLoad"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"onReady"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"onError")," handlers will not work in Server Components so make sure to move them to a ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/rendering/server-components"},"Client Component")," or remove them altogether.")),(0,i.kt)("h3",{id:"font-optimization"},"Font Optimization"),(0,i.kt)("p",null,"Previously, Next.js helped you optimize fonts by ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/optimizing/fonts"},"inlining font CSS"),". Version 13 introduces the new ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/optimizing/fonts"},(0,i.kt)("inlineCode",{parentName:"a"},"next/font"))," module which gives you the ability to customize your font loading experience while still ensuring great performance and privacy. ",(0,i.kt)("inlineCode",{parentName:"p"},"next/font")," is supported in both the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directories."),(0,i.kt)("p",null,"While ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/optimizing/fonts"},"inlining CSS")," still works in ",(0,i.kt)("inlineCode",{parentName:"p"},"pages"),", it does not work in ",(0,i.kt)("inlineCode",{parentName:"p"},"app"),". You should use ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/optimizing/fonts"},(0,i.kt)("inlineCode",{parentName:"a"},"next/font"))," instead."),(0,i.kt)("p",null,"See the ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/optimizing/fonts"},"Font Optimization")," page to learn how to use ",(0,i.kt)("inlineCode",{parentName:"p"},"next/font"),"."),(0,i.kt)("h2",{id:"migrating-from-pages-to-app"},"Migrating from ",(0,i.kt)("inlineCode",{parentName:"h2"},"pages")," to ",(0,i.kt)("inlineCode",{parentName:"h2"},"app")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"\ud83c\udfa5 Watch:")," Learn how to incrementally adopt the App Router \u2192 ",(0,i.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=YQMSietiFm0"},"YouTube (16 minutes)"),".")),(0,i.kt)("p",null,"Moving to the App Router may be the first time using React features that Next.js builds on top of such as Server Components, Suspense, and more. When combined with new Next.js features such as ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing#file-conventions"},"special files")," and ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/pages-and-layouts#layouts"},"layouts"),", migration means new concepts, mental models, and behavioral changes to learn."),(0,i.kt)("p",null,"We recommend reducing the combined complexity of these updates by breaking down your migration into smaller steps. The ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory is intentionally designed to work simultaneously with the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory to allow for incremental page-by-page migration."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," directory supports nested routes ",(0,i.kt)("em",{parentName:"li"},"and")," layouts. ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing"},"Learn more"),"."),(0,i.kt)("li",{parentName:"ul"},"Use nested folders to ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing/defining-routes"},"define routes")," and a special ",(0,i.kt)("inlineCode",{parentName:"li"},"page.js")," file to make a route segment publicly accessible. ",(0,i.kt)("a",{parentName:"li",href:"#step-4-migrating-pages"},"Learn more"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing#file-conventions"},"Special file conventions")," are used to create UI for each route segment. The most common special files are ",(0,i.kt)("inlineCode",{parentName:"li"},"page.js")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"layout.js"),".",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Use ",(0,i.kt)("inlineCode",{parentName:"li"},"page.js")," to define UI unique to a route."),(0,i.kt)("li",{parentName:"ul"},"Use ",(0,i.kt)("inlineCode",{parentName:"li"},"layout.js")," to define UI that is shared across multiple routes."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".js"),", ",(0,i.kt)("inlineCode",{parentName:"li"},".jsx"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},".tsx")," file extensions can be used for special files."))),(0,i.kt)("li",{parentName:"ul"},"You can colocate other files inside the ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," directory such as components, styles, tests, and more. ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing"},"Learn more"),"."),(0,i.kt)("li",{parentName:"ul"},"Data fetching functions like ",(0,i.kt)("inlineCode",{parentName:"li"},"getServerSideProps")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"getStaticProps")," have been replaced with ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/data-fetching"},"a new API")," inside ",(0,i.kt)("inlineCode",{parentName:"li"},"app"),". ",(0,i.kt)("inlineCode",{parentName:"li"},"getStaticPaths")," has been replaced with ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/api-reference/functions/generate-static-params"},(0,i.kt)("inlineCode",{parentName:"a"},"generateStaticParams")),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"pages/_app.js")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"pages/_document.js")," have been replaced with a single ",(0,i.kt)("inlineCode",{parentName:"li"},"app/layout.js")," root layout. ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing/pages-and-layouts#root-layout-required"},"Learn more"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"pages/_error.js")," has been replaced with more granular ",(0,i.kt)("inlineCode",{parentName:"li"},"error.js")," special files. ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing/error-handling"},"Learn more"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"pages/404.js")," has been replaced with the ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/api-reference/file-conventions/not-found"},(0,i.kt)("inlineCode",{parentName:"a"},"not-found.js"))," file."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"pages/api/*")," currently remain inside the ",(0,i.kt)("inlineCode",{parentName:"li"},"pages")," directory.")),(0,i.kt)("h3",{id:"step-1-creating-the-app-directory"},"Step 1: Creating the ",(0,i.kt)("inlineCode",{parentName:"h3"},"app")," directory"),(0,i.kt)("p",null,"Update to the latest Next.js version (requires 13.4 or greater):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"npm install next@latest\n")),(0,i.kt)("p",null,"Then, create a new ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory at the root of your project (or ",(0,i.kt)("inlineCode",{parentName:"p"},"src/")," directory)."),(0,i.kt)("h3",{id:"step-2-creating-a-root-layout"},"Step 2: Creating a Root Layout"),(0,i.kt)("p",null,"Create a new ",(0,i.kt)("inlineCode",{parentName:"p"},"app/layout.tsx")," file inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory. This is a ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/pages-and-layouts#root-layout-required"},"root layout")," that will apply to all routes inside ",(0,i.kt)("inlineCode",{parentName:"p"},"app"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/layout.tsx" switcher',filename:'"app/layout.tsx"',switcher:!0},'export default function RootLayout({\n    // Layouts must accept a children prop.\n    // This will be populated with nested layouts or pages\n    children,\n}: {\n    children: React.ReactNode;\n}) {\n    return (\n        <html lang="en">\n            <body>{children}</body>\n        </html>\n    );\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/layout.js" switcher',filename:'"app/layout.js"',switcher:!0},'export default function RootLayout({\n    // Layouts must accept a children prop.\n    // This will be populated with nested layouts or pages\n    children,\n}) {\n    return (\n        <html lang="en">\n            <body>{children}</body>\n        </html>\n    );\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," directory ",(0,i.kt)("strong",{parentName:"li"},"must")," include a root layout."),(0,i.kt)("li",{parentName:"ul"},"The root layout must define ",(0,i.kt)("inlineCode",{parentName:"li"},"<html>"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"<body>")," tags since Next.js does not automatically create them"),(0,i.kt)("li",{parentName:"ul"},"The root layout replaces the ",(0,i.kt)("inlineCode",{parentName:"li"},"pages/_app.tsx")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"pages/_document.tsx")," files."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},".js"),", ",(0,i.kt)("inlineCode",{parentName:"li"},".jsx"),", or ",(0,i.kt)("inlineCode",{parentName:"li"},".tsx")," extensions can be used for layout files.")),(0,i.kt)("p",null,"To manage ",(0,i.kt)("inlineCode",{parentName:"p"},"<head>")," HTML elements, you can use the ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/optimizing/metadata"},"built-in SEO support"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/layout.tsx" switcher',filename:'"app/layout.tsx"',switcher:!0},'import { Metadata } from "next";\n\nexport const metadata: Metadata = {\n    title: "Home",\n    description: "Welcome to Next.js",\n};\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/layout.js" switcher',filename:'"app/layout.js"',switcher:!0},'export const metadata = {\n    title: "Home",\n    description: "Welcome to Next.js",\n};\n')),(0,i.kt)("h4",{id:"migrating-_documentjs-and-_appjs"},"Migrating ",(0,i.kt)("inlineCode",{parentName:"h4"},"_document.js")," and ",(0,i.kt)("inlineCode",{parentName:"h4"},"_app.js")),(0,i.kt)("p",null,"If you have an existing ",(0,i.kt)("inlineCode",{parentName:"p"},"_app")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"_document")," file, you can copy the contents (e.g. global styles) to the root layout (",(0,i.kt)("inlineCode",{parentName:"p"},"app/layout.tsx"),"). Styles in ",(0,i.kt)("inlineCode",{parentName:"p"},"app/layout.tsx")," will ",(0,i.kt)("em",{parentName:"p"},"not")," apply to ",(0,i.kt)("inlineCode",{parentName:"p"},"pages/*"),". You should keep ",(0,i.kt)("inlineCode",{parentName:"p"},"_app"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"_document")," while migrating to prevent your ",(0,i.kt)("inlineCode",{parentName:"p"},"pages/*")," routes from breaking. Once fully migrated, you can then safely delete them."),(0,i.kt)("p",null,"If you are using any React Context providers, they will need to be moved to a ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/rendering/client-components"},"Client Component"),"."),(0,i.kt)("h4",{id:"migrating-the-getlayout-pattern-to-layouts-optional"},"Migrating the ",(0,i.kt)("inlineCode",{parentName:"h4"},"getLayout()")," pattern to Layouts (Optional)"),(0,i.kt)("p",null,"Next.js recommended adding a ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/building-your-application/routing/pages-and-layouts#layout-pattern#per-page-layouts"},"property to Page components")," to achieve per-page layouts in the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory. This pattern can be replaced with native support for ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/pages-and-layouts#layouts"},"nested layouts")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory."),(0,i.kt)("details",null,(0,i.kt)("summary",null,"See before and after example"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Before")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="components/DashboardLayout.js"',filename:'"components/DashboardLayout.js"'},"export default function DashboardLayout({ children }) {\n    return (\n        <div>\n            <h2>My Dashboard</h2>\n            {children}\n        </div>\n    );\n}\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/dashboard/index.js"',filename:'"pages/dashboard/index.js"'},'import DashboardLayout from "../components/DashboardLayout";\n\nexport default function Page() {\n    return <p>My Page</p>;\n}\n\nPage.getLayout = function getLayout(page) {\n    return <DashboardLayout>{page}</DashboardLayout>;\n};\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"After")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Remove the ",(0,i.kt)("inlineCode",{parentName:"p"},"Page.getLayout")," property from ",(0,i.kt)("inlineCode",{parentName:"p"},"pages/dashboard/index.js")," and follow the ",(0,i.kt)("a",{parentName:"p",href:"#step-4-migrating-pages"},"steps for migrating pages")," to the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/dashboard/page.js"',filename:'"app/dashboard/page.js"'},"export default function Page() {\n    return <p>My Page</p>;\n}\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Move the contents of ",(0,i.kt)("inlineCode",{parentName:"p"},"DashboardLayout")," into a new ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/rendering/client-components"},"Client Component")," to retain ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory behavior."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/dashboard/DashboardLayout.js"',filename:'"app/dashboard/DashboardLayout.js"'},'"use client"; // this directive should be at top of the file, before any imports.\n\n// This is a Client Component\nexport default function DashboardLayout({ children }) {\n    return (\n        <div>\n            <h2>My Dashboard</h2>\n            {children}\n        </div>\n    );\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Import the ",(0,i.kt)("inlineCode",{parentName:"p"},"DashboardLayout")," into a new ",(0,i.kt)("inlineCode",{parentName:"p"},"layout.js")," file inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/dashboard/layout.js"',filename:'"app/dashboard/layout.js"'},'import DashboardLayout from "./DashboardLayout";\n\n// This is a Server Component\nexport default function Layout({ children }) {\n    return <DashboardLayout>{children}</DashboardLayout>;\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can incrementally move non-interactive parts of ",(0,i.kt)("inlineCode",{parentName:"p"},"DashboardLayout.js")," (Client Component) into ",(0,i.kt)("inlineCode",{parentName:"p"},"layout.js")," (Server Component) to reduce the amount of component JavaScript you send to the client.")))),(0,i.kt)("h3",{id:"step-3-migrating-nexthead"},"Step 3: Migrating ",(0,i.kt)("inlineCode",{parentName:"h3"},"next/head")),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory, the ",(0,i.kt)("inlineCode",{parentName:"p"},"next/head")," React component is used to manage ",(0,i.kt)("inlineCode",{parentName:"p"},"<head>")," HTML elements such as ",(0,i.kt)("inlineCode",{parentName:"p"},"title")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"meta")," . In the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory, ",(0,i.kt)("inlineCode",{parentName:"p"},"next/head")," is replaced with the new ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/optimizing/metadata"},"built-in SEO support"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Before:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="pages/index.tsx" switcher',filename:'"pages/index.tsx"',switcher:!0},'import Head from "next/head";\n\nexport default function Page() {\n    return (\n        <>\n            <Head>\n                <title>My page title</title>\n            </Head>\n        </>\n    );\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/index.js" switcher',filename:'"pages/index.js"',switcher:!0},'import Head from "next/head";\n\nexport default function Page() {\n    return (\n        <>\n            <Head>\n                <title>My page title</title>\n            </Head>\n        </>\n    );\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"After:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/page.tsx" switcher',filename:'"app/page.tsx"',switcher:!0},'import { Metadata } from "next";\n\nexport const metadata: Metadata = {\n    title: "My Page Title",\n};\n\nexport default function Page() {\n    return "...";\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/page.js" switcher',filename:'"app/page.js"',switcher:!0},'export const metadata = {\n    title: "My Page Title",\n};\n\nexport default function Page() {\n    return "...";\n}\n')),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/generate-metadata"},"See all metadata options"),"."),(0,i.kt)("h3",{id:"step-4-migrating-pages"},"Step 4: Migrating Pages"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Pages in the ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing"},(0,i.kt)("inlineCode",{parentName:"a"},"app")," directory")," are ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/rendering/server-components"},"Server Components")," by default. This is different from the ",(0,i.kt)("inlineCode",{parentName:"li"},"pages")," directory where pages are ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/rendering/client-components"},"Client Components"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/data-fetching"},"Data fetching")," has changed in ",(0,i.kt)("inlineCode",{parentName:"li"},"app"),". ",(0,i.kt)("inlineCode",{parentName:"li"},"getServerSideProps"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"getStaticProps")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"getInitialProps")," have been replaced with a simpler API."),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," directory uses nested folders to ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing/defining-routes"},"define routes")," and a special ",(0,i.kt)("inlineCode",{parentName:"li"},"page.js")," file to make a route segment publicly accessible."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("table",{parentName:"li"},(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"th"},"pages")," Directory"),(0,i.kt)("th",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"th"},"app")," Directory"),(0,i.kt)("th",{parentName:"tr",align:null},"Route"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"index.js")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"page.js")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"about.js")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"about/page.js")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/about"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"blog/[slug].js")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"blog/[slug]/page.js")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/blog/post-1"))))))),(0,i.kt)("p",null,"We recommend breaking down the migration of a page into two main steps:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Step 1: Move the default exported Page Component into a new Client Component."),(0,i.kt)("li",{parentName:"ul"},"Step 2: Import the new Client Component into a new ",(0,i.kt)("inlineCode",{parentName:"li"},"page.js")," file inside the ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," directory.")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": This is the easiest migration path because it has the most comparable behavior to the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Step 1: Create a new Client Component")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create a new separate file inside the ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," directory (i.e. ",(0,i.kt)("inlineCode",{parentName:"li"},"app/home-page.tsx")," or similar) that exports a Client Component. To define Client Components, add the ",(0,i.kt)("inlineCode",{parentName:"li"},"'use client'")," directive to the top of the file (before any imports)."),(0,i.kt)("li",{parentName:"ul"},"Move the default exported page component from ",(0,i.kt)("inlineCode",{parentName:"li"},"pages/index.js")," to ",(0,i.kt)("inlineCode",{parentName:"li"},"app/home-page.tsx"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/home-page.tsx" switcher',filename:'"app/home-page.tsx"',switcher:!0},'"use client";\n\n// This is a Client Component. It receives data as props and\n// has access to state and effects just like Page components\n// in the `pages` directory.\nexport default function HomePage({ recentPosts }) {\n    return (\n        <div>\n            {recentPosts.map((post) => (\n                <div key={post.id}>{post.title}</div>\n            ))}\n        </div>\n    );\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/home-page.js" switcher',filename:'"app/home-page.js"',switcher:!0},'"use client";\n\n// This is a Client Component. It receives data as props and\n// has access to state and effects just like Page components\n// in the `pages` directory.\nexport default function HomePage({ recentPosts }) {\n    return (\n        <div>\n            {recentPosts.map((post) => (\n                <div key={post.id}>{post.title}</div>\n            ))}\n        </div>\n    );\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Step 2: Create a new page")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Create a new ",(0,i.kt)("inlineCode",{parentName:"p"},"app/page.tsx")," file inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory. This is a Server Component by default.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Import the ",(0,i.kt)("inlineCode",{parentName:"p"},"home-page.tsx")," Client Component into the page.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"If you were fetching data in ",(0,i.kt)("inlineCode",{parentName:"p"},"pages/index.js"),", move the data fetching logic directly into the Server Component using the new ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating"},"data fetching APIs"),". See the ",(0,i.kt)("a",{parentName:"p",href:"#step-6-migrating-data-fetching-methods"},"data fetching upgrade guide")," for more details."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/page.tsx" switcher',filename:'"app/page.tsx"',switcher:!0},'// Import your Client Component\nimport HomePage from "./home-page";\n\nasync function getPosts() {\n    const res = await fetch("https://...");\n    const posts = await res.json();\n    return posts;\n}\n\nexport default async function Page() {\n    // Fetch data directly in a Server Component\n    const recentPosts = await getPosts();\n    // Forward fetched data to your Client Component\n    return <HomePage recentPosts={recentPosts} />;\n}\n')),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/page.js" switcher',filename:'"app/page.js"',switcher:!0},'// Import your Client Component\nimport HomePage from "./home-page";\n\nasync function getPosts() {\n    const res = await fetch("https://...");\n    const posts = await res.json();\n    return posts;\n}\n\nexport default async function Page() {\n    // Fetch data directly in a Server Component\n    const recentPosts = await getPosts();\n    // Forward fetched data to your Client Component\n    return <HomePage recentPosts={recentPosts} />;\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"If your previous page used ",(0,i.kt)("inlineCode",{parentName:"p"},"useRouter"),", you'll need to update to the new routing hooks. ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/use-router"},"Learn more"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Start your development server and visit ",(0,i.kt)("a",{parentName:"p",href:"http://localhost:3000"},(0,i.kt)("inlineCode",{parentName:"a"},"http://localhost:3000")),". You should see your existing index route, now served through the app directory."))),(0,i.kt)("h3",{id:"step-5-migrating-routing-hooks"},"Step 5: Migrating Routing Hooks"),(0,i.kt)("p",null,"A new router has been added to support the new behavior in the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory."),(0,i.kt)("p",null,"In ",(0,i.kt)("inlineCode",{parentName:"p"},"app"),", you should use the three new hooks imported from ",(0,i.kt)("inlineCode",{parentName:"p"},"next/navigation"),": ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/use-router"},(0,i.kt)("inlineCode",{parentName:"a"},"useRouter()")),", ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/use-pathname"},(0,i.kt)("inlineCode",{parentName:"a"},"usePathname()")),", and ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/use-search-params"},(0,i.kt)("inlineCode",{parentName:"a"},"useSearchParams()")),"."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The new ",(0,i.kt)("inlineCode",{parentName:"li"},"useRouter")," hook is imported from ",(0,i.kt)("inlineCode",{parentName:"li"},"next/navigation")," and has different behavior to the ",(0,i.kt)("inlineCode",{parentName:"li"},"useRouter")," hook in ",(0,i.kt)("inlineCode",{parentName:"li"},"pages")," which is imported from ",(0,i.kt)("inlineCode",{parentName:"li"},"next/router"),".",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{parentName:"li",href:"/docs/pages/api-reference/functions/use-router"},(0,i.kt)("inlineCode",{parentName:"a"},"useRouter")," hook imported from ",(0,i.kt)("inlineCode",{parentName:"a"},"next/router"))," is not supported in the ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," directory but can continue to be used in the ",(0,i.kt)("inlineCode",{parentName:"li"},"pages")," directory."))),(0,i.kt)("li",{parentName:"ul"},"The new ",(0,i.kt)("inlineCode",{parentName:"li"},"useRouter")," does not return the ",(0,i.kt)("inlineCode",{parentName:"li"},"pathname")," string. Use the separate ",(0,i.kt)("inlineCode",{parentName:"li"},"usePathname")," hook instead."),(0,i.kt)("li",{parentName:"ul"},"The new ",(0,i.kt)("inlineCode",{parentName:"li"},"useRouter")," does not return the ",(0,i.kt)("inlineCode",{parentName:"li"},"query")," object. Use the separate ",(0,i.kt)("inlineCode",{parentName:"li"},"useSearchParams")," hook instead."),(0,i.kt)("li",{parentName:"ul"},"You can use ",(0,i.kt)("inlineCode",{parentName:"li"},"useSearchParams")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"usePathname")," together to listen to page changes. See the ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/api-reference/functions/use-router#router-events"},"Router Events")," section for more details."),(0,i.kt)("li",{parentName:"ul"},"These new hooks are only supported in Client Components. They cannot be used in Server Components.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/example-client-component.tsx" switcher',filename:'"app/example-client-component.tsx"',switcher:!0},'"use client";\n\nimport { useRouter, usePathname, useSearchParams } from "next/navigation";\n\nexport default function ExampleClientComponent() {\n    const router = useRouter();\n    const pathname = usePathname();\n    const searchParams = useSearchParams();\n\n    // ...\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/example-client-component.js" switcher',filename:'"app/example-client-component.js"',switcher:!0},'"use client";\n\nimport { useRouter, usePathname, useSearchParams } from "next/navigation";\n\nexport default function ExampleClientComponent() {\n    const router = useRouter();\n    const pathname = usePathname();\n    const searchParams = useSearchParams();\n\n    // ...\n}\n')),(0,i.kt)("p",null,"In addition, the new ",(0,i.kt)("inlineCode",{parentName:"p"},"useRouter")," hook has the following changes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"isFallback")," has been removed because ",(0,i.kt)("inlineCode",{parentName:"li"},"fallback")," has ",(0,i.kt)("a",{parentName:"li",href:"#replacing-fallback"},"been replaced"),"."),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("inlineCode",{parentName:"li"},"locale"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"locales"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"defaultLocales"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"domainLocales")," values have been removed because built-in i18n Next.js features are no longer necessary in the ",(0,i.kt)("inlineCode",{parentName:"li"},"app")," directory. ",(0,i.kt)("a",{parentName:"li",href:"/docs/pages/building-your-application/routing/internationalization"},"Learn more about i18n"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"basePath")," has been removed. The alternative will not be part of ",(0,i.kt)("inlineCode",{parentName:"li"},"useRouter"),". It has not yet been implemented."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"asPath")," has been removed because the concept of ",(0,i.kt)("inlineCode",{parentName:"li"},"as")," has been removed from the new router."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"isReady")," has been removed because it is no longer necessary. During ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/rendering/server-components#static-rendering-default"},"static rendering"),", any component that uses the ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/api-reference/functions/use-params"},(0,i.kt)("inlineCode",{parentName:"a"},"useSearchParams()"))," hook will skip the prerendering step and instead be rendered on the client at runtime.")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/use-router"},"View the ",(0,i.kt)("inlineCode",{parentName:"a"},"useRouter()")," API reference"),"."),(0,i.kt)("h3",{id:"step-6-migrating-data-fetching-methods"},"Step 6: Migrating Data Fetching Methods"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory uses ",(0,i.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," to fetch data for pages. Inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory, these previous data fetching functions are replaced with a ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/data-fetching"},"simpler API")," built on top of ",(0,i.kt)("inlineCode",{parentName:"p"},"fetch()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"async")," React Server Components."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/page.tsx" switcher',filename:'"app/page.tsx"',switcher:!0},'export default async function Page() {\n    // This request should be cached until manually invalidated.\n    // Similar to `getStaticProps`.\n    // `force-cache` is the default and can be omitted.\n    const staticData = await fetch(`https://...`, { cache: "force-cache" });\n\n    // This request should be refetched on every request.\n    // Similar to `getServerSideProps`.\n    const dynamicData = await fetch(`https://...`, { cache: "no-store" });\n\n    // This request should be cached with a lifetime of 10 seconds.\n    // Similar to `getStaticProps` with the `revalidate` option.\n    const revalidatedData = await fetch(`https://...`, {\n        next: { revalidate: 10 },\n    });\n\n    return <div>...</div>;\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/page.js" switcher',filename:'"app/page.js"',switcher:!0},'export default async function Page() {\n    // This request should be cached until manually invalidated.\n    // Similar to `getStaticProps`.\n    // `force-cache` is the default and can be omitted.\n    const staticData = await fetch(`https://...`, { cache: "force-cache" });\n\n    // This request should be refetched on every request.\n    // Similar to `getServerSideProps`.\n    const dynamicData = await fetch(`https://...`, { cache: "no-store" });\n\n    // This request should be cached with a lifetime of 10 seconds.\n    // Similar to `getStaticProps` with the `revalidate` option.\n    const revalidatedData = await fetch(`https://...`, {\n        next: { revalidate: 10 },\n    });\n\n    return <div>...</div>;\n}\n')),(0,i.kt)("h4",{id:"server-side-rendering-getserversideprops"},"Server-side Rendering (",(0,i.kt)("inlineCode",{parentName:"h4"},"getServerSideProps"),")"),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory, ",(0,i.kt)("inlineCode",{parentName:"p"},"getServerSideProps"),' is used to fetch data on the server and forward props to the default exported React component in the file. The initial HTML for the page is prerendered from the server, followed by "hydrating" the page in the browser (making it interactive).'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/dashboard.js"',filename:'"pages/dashboard.js"'},"// `pages` directory\n\nexport async function getServerSideProps() {\n    const res = await fetch(`https://...`);\n    const projects = await res.json();\n\n    return { props: { projects } };\n}\n\nexport default function Dashboard({ projects }) {\n    return (\n        <ul>\n            {projects.map((project) => (\n                <li key={project.id}>{project.name}</li>\n            ))}\n        </ul>\n    );\n}\n")),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory, we can colocate our data fetching inside our React components using ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/rendering/server-components"},"Server Components"),". This allows us to send less JavaScript to the client, while maintaining the rendered HTML from the server."),(0,i.kt)("p",null,"By setting the ",(0,i.kt)("inlineCode",{parentName:"p"},"cache")," option to ",(0,i.kt)("inlineCode",{parentName:"p"},"no-store"),", we can indicate that the fetched data should ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating"},"never be cached"),". This is similar to ",(0,i.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/dashboard/page.tsx" switcher',filename:'"app/dashboard/page.tsx"',switcher:!0},'// `app` directory\n\n// This function can be named anything\nasync function getProjects() {\n    const res = await fetch(`https://...`, { cache: "no-store" });\n    const projects = await res.json();\n\n    return projects;\n}\n\nexport default async function Dashboard() {\n    const projects = await getProjects();\n\n    return (\n        <ul>\n            {projects.map((project) => (\n                <li key={project.id}>{project.name}</li>\n            ))}\n        </ul>\n    );\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/dashboard/page.js" switcher',filename:'"app/dashboard/page.js"',switcher:!0},'// `app` directory\n\n// This function can be named anything\nasync function getProjects() {\n    const res = await fetch(`https://...`, { cache: "no-store" });\n    const projects = await res.json();\n\n    return projects;\n}\n\nexport default async function Dashboard() {\n    const projects = await getProjects();\n\n    return (\n        <ul>\n            {projects.map((project) => (\n                <li key={project.id}>{project.name}</li>\n            ))}\n        </ul>\n    );\n}\n')),(0,i.kt)("h4",{id:"accessing-request-object"},"Accessing Request Object"),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory, you can retrieve request-based data based on the Node.js HTTP API."),(0,i.kt)("p",null,"For example, you can retrieve the ",(0,i.kt)("inlineCode",{parentName:"p"},"req")," object from ",(0,i.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," and use it to retrieve the request's cookies and headers."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/index.js"',filename:'"pages/index.js"'},"// `pages` directory\n\nexport async function getServerSideProps({ req, query }) {\n  const authHeader = req.getHeaders()['authorization'];\n  const theme = req.cookies['theme'];\n\n  return { props: { ... }}\n}\n\nexport default function Page(props) {\n  return ...\n}\n")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory exposes new read-only functions to retrieve request data:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/api-reference/functions/headers"},(0,i.kt)("inlineCode",{parentName:"a"},"headers()")),": Based on the Web Headers API, and can be used inside ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/rendering/server-components"},"Server Components")," to retrieve request headers."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/api-reference/functions/cookies"},(0,i.kt)("inlineCode",{parentName:"a"},"cookies()")),": Based on the Web Cookies API, and can be used inside ",(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/rendering/server-components"},"Server Components")," to retrieve cookies.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/page.tsx" switcher',filename:'"app/page.tsx"',switcher:!0},'// `app` directory\nimport { cookies, headers } from "next/headers";\n\nasync function getData() {\n    const authHeader = headers().get("authorization");\n\n    return "...";\n}\n\nexport default async function Page() {\n    // You can use `cookies()` or `headers()` inside Server Components\n    // directly or in your data fetching function\n    const theme = cookies().get("theme");\n    const data = await getData();\n    return "...";\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/page.js" switcher',filename:'"app/page.js"',switcher:!0},'// `app` directory\nimport { cookies, headers } from "next/headers";\n\nasync function getData() {\n    const authHeader = headers().get("authorization");\n\n    return "...";\n}\n\nexport default async function Page() {\n    // You can use `cookies()` or `headers()` inside Server Components\n    // directly or in your data fetching function\n    const theme = cookies().get("theme");\n    const data = await getData();\n    return "...";\n}\n')),(0,i.kt)("h4",{id:"static-site-generation-getstaticprops"},"Static Site Generation (",(0,i.kt)("inlineCode",{parentName:"h4"},"getStaticProps"),")"),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory, the ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," function is used to pre-render a page at build time. This function can be used to fetch data from an external API or directly from a database, and pass this data down to the entire page as it's being generated during the build."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/index.js"',filename:'"pages/index.js"'},"// `pages` directory\n\nexport async function getStaticProps() {\n    const res = await fetch(`https://...`);\n    const projects = await res.json();\n\n    return { props: { projects } };\n}\n\nexport default function Index({ projects }) {\n    return projects.map((project) => <div>{project.name}</div>);\n}\n")),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory, data fetching with ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/fetch"},(0,i.kt)("inlineCode",{parentName:"a"},"fetch()"))," will default to ",(0,i.kt)("inlineCode",{parentName:"p"},"cache: 'force-cache'"),", which will cache the request data until manually invalidated. This is similar to ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/page.js"',filename:'"app/page.js"'},"// `app` directory\n\n// This function can be named anything\nasync function getProjects() {\n    const res = await fetch(`https://...`);\n    const projects = await res.json();\n\n    return projects;\n}\n\nexport default async function Index() {\n    const projects = await getProjects();\n\n    return projects.map((project) => <div>{project.name}</div>);\n}\n")),(0,i.kt)("h4",{id:"dynamic-paths-getstaticpaths"},"Dynamic paths (",(0,i.kt)("inlineCode",{parentName:"h4"},"getStaticPaths"),")"),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory, the ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticPaths")," function is used to define the dynamic paths that should be pre-rendered at build time."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/posts/[id].js"',filename:'"pages/posts/[id].js"'},'// `pages` directory\nimport PostLayout from "@/components/post-layout";\n\nexport async function getStaticPaths() {\n    return {\n        paths: [{ params: { id: "1" } }, { params: { id: "2" } }],\n    };\n}\n\nexport async function getStaticProps({ params }) {\n    const res = await fetch(`https://.../posts/${params.id}`);\n    const post = await res.json();\n\n    return { props: { post } };\n}\n\nexport default function Post({ post }) {\n    return <PostLayout post={post} />;\n}\n')),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory, ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticPaths")," is replaced with ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/generate-static-params"},(0,i.kt)("inlineCode",{parentName:"a"},"generateStaticParams")),"."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/generate-static-params"},(0,i.kt)("inlineCode",{parentName:"a"},"generateStaticParams"))," behaves similarly to ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticPaths"),", but has a simplified API for returning route parameters and can be used inside ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/pages-and-layouts"},"layouts"),". The return shape of ",(0,i.kt)("inlineCode",{parentName:"p"},"generateStaticParams")," is an array of segments instead of an array of nested ",(0,i.kt)("inlineCode",{parentName:"p"},"param")," objects or a string of resolved paths."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/posts/[id]/page.js"',filename:'"app/posts/[id]/page.js"'},'// `app` directory\nimport PostLayout from "@/components/post-layout";\n\nexport async function generateStaticParams() {\n    return [{ id: "1" }, { id: "2" }];\n}\n\nasync function getPost(params) {\n    const res = await fetch(`https://.../posts/${params.id}`);\n    const post = await res.json();\n\n    return post;\n}\n\nexport default async function Post({ params }) {\n    const post = await getPost(params);\n\n    return <PostLayout post={post} />;\n}\n')),(0,i.kt)("p",null,"Using the name ",(0,i.kt)("inlineCode",{parentName:"p"},"generateStaticParams")," is more appropriate than ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticPaths")," for the new model in the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory. The ",(0,i.kt)("inlineCode",{parentName:"p"},"get")," prefix is replaced with a more descriptive ",(0,i.kt)("inlineCode",{parentName:"p"},"generate"),", which sits better alone now that ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"getServerSideProps")," are no longer necessary. The ",(0,i.kt)("inlineCode",{parentName:"p"},"Paths")," suffix is replaced by ",(0,i.kt)("inlineCode",{parentName:"p"},"Params"),", which is more appropriate for nested routing with multiple dynamic segments."),(0,i.kt)("hr",null),(0,i.kt)("h4",{id:"replacing-fallback"},"Replacing ",(0,i.kt)("inlineCode",{parentName:"h4"},"fallback")),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory, the ",(0,i.kt)("inlineCode",{parentName:"p"},"fallback")," property returned from ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticPaths")," is used to define the behavior of a page that isn't pre-rendered at build time. This property can be set to ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," to show a fallback page while the page is being generated, ",(0,i.kt)("inlineCode",{parentName:"p"},"false")," to show a 404 page, or ",(0,i.kt)("inlineCode",{parentName:"p"},"blocking")," to generate the page at request time."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/posts/[id].js"',filename:'"pages/posts/[id].js"'},"// `pages` directory\n\nexport async function getStaticPaths() {\n  return {\n    paths: [],\n    fallback: 'blocking'\n  };\n}\n\nexport async function getStaticProps({ params }) {\n  ...\n}\n\nexport default function Post({ post }) {\n  return ...\n}\n")),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory the ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams"},(0,i.kt)("inlineCode",{parentName:"a"},"config.dynamicParams")," property")," controls how params outside of ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/generate-static-params"},(0,i.kt)("inlineCode",{parentName:"a"},"generateStaticParams"))," are handled:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"true")),": (default) Dynamic segments not included in ",(0,i.kt)("inlineCode",{parentName:"li"},"generateStaticParams")," are generated on demand."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"false")),": Dynamic segments not included in ",(0,i.kt)("inlineCode",{parentName:"li"},"generateStaticParams")," will return a 404.")),(0,i.kt)("p",null,"This replaces the ",(0,i.kt)("inlineCode",{parentName:"p"},"fallback: true | false | 'blocking'")," option of ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticPaths")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory. The ",(0,i.kt)("inlineCode",{parentName:"p"},"fallback: 'blocking'")," option is not included in ",(0,i.kt)("inlineCode",{parentName:"p"},"dynamicParams")," because the difference between ",(0,i.kt)("inlineCode",{parentName:"p"},"'blocking'")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," is negligible with streaming."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/posts/[id]/page.js"',filename:'"app/posts/[id]/page.js"'},"// `app` directory\n\nexport const dynamicParams = true;\n\nexport async function generateStaticParams() {\n  return [...]\n}\n\nasync function getPost(params) {\n  ...\n}\n\nexport default async function Post({ params }) {\n  const post = await getPost(params);\n\n  return ...\n}\n")),(0,i.kt)("p",null,"With ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/file-conventions/route-segment-config#dynamicparams"},(0,i.kt)("inlineCode",{parentName:"a"},"dynamicParams"))," set to ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," (the default), when a route segment is requested that hasn't been generated, it will be server-rendered and cached."),(0,i.kt)("h4",{id:"incremental-static-regeneration-getstaticprops-with-revalidate"},"Incremental Static Regeneration (",(0,i.kt)("inlineCode",{parentName:"h4"},"getStaticProps")," with ",(0,i.kt)("inlineCode",{parentName:"h4"},"revalidate"),")"),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory, the ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," function allows you to add a ",(0,i.kt)("inlineCode",{parentName:"p"},"revalidate")," field to automatically regenerate a page after a certain amount of time."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/index.js"',filename:'"pages/index.js"'},"// `pages` directory\n\nexport async function getStaticProps() {\n    const res = await fetch(`https://.../posts`);\n    const posts = await res.json();\n\n    return {\n        props: { posts },\n        revalidate: 60,\n    };\n}\n\nexport default function Index({ posts }) {\n    return (\n        <Layout>\n            <PostList posts={posts} />\n        </Layout>\n    );\n}\n")),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory, data fetching with ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/api-reference/functions/fetch"},(0,i.kt)("inlineCode",{parentName:"a"},"fetch()"))," can use ",(0,i.kt)("inlineCode",{parentName:"p"},"revalidate"),", which will cache the request for the specified amount of seconds."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/page.js"',filename:'"app/page.js"'},"// `app` directory\n\nasync function getPosts() {\n    const res = await fetch(`https://.../posts`, { next: { revalidate: 60 } });\n    const data = await res.json();\n\n    return data.posts;\n}\n\nexport default async function PostList() {\n    const posts = await getPosts();\n\n    return posts.map((post) => <div>{post.name}</div>);\n}\n")),(0,i.kt)("h4",{id:"api-routes"},"API Routes"),(0,i.kt)("p",null,"API Routes continue to work in the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages/api")," directory without any changes. However, they have been replaced by ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/routing/route-handlers"},"Route Handlers")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory."),(0,i.kt)("p",null,"Route Handlers allow you to create custom request handlers for a given route using the Web ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/docs/Web/API/Request"},"Request")," and ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/docs/Web/API/Response"},"Response")," APIs."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:'filename="app/api/route.ts" switcher',filename:'"app/api/route.ts"',switcher:!0},"export async function GET(request: Request) {}\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="app/api/route.js" switcher',filename:'"app/api/route.js"',switcher:!0},"export async function GET(request) {}\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": If you previously used API routes to call an external API from the client, you can now use ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/rendering/server-components"},"Server Components")," instead to securely fetch data. Learn more about ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating"},"data fetching"),".")),(0,i.kt)("h3",{id:"step-7-styling"},"Step 7: Styling"),(0,i.kt)("p",null,"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages")," directory, global stylesheets are restricted to only ",(0,i.kt)("inlineCode",{parentName:"p"},"pages/_app.js"),". With the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory, this restriction has been lifted. Global styles can be added to any layout, page, or component."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/styling/css-modules"},"CSS Modules")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/styling/tailwind-css"},"Tailwind CSS")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/styling/css-modules#global-styles"},"Global Styles")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/styling/css-in-js"},"CSS-in-JS")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/styling/css-modules#external-stylesheets"},"External Stylesheets")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/styling/sass"},"Sass"))),(0,i.kt)("h4",{id:"tailwind-css"},"Tailwind CSS"),(0,i.kt)("p",null,"If you're using Tailwind CSS, you'll need to add the ",(0,i.kt)("inlineCode",{parentName:"p"},"app")," directory to your ",(0,i.kt)("inlineCode",{parentName:"p"},"tailwind.config.js")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="tailwind.config.js"',filename:'"tailwind.config.js"'},'module.exports = {\n    content: [\n        "./app/**/*.{js,ts,jsx,tsx,mdx}", // <-- Add this line\n        "./pages/**/*.{js,ts,jsx,tsx,mdx}",\n        "./components/**/*.{js,ts,jsx,tsx,mdx}",\n    ],\n};\n')),(0,i.kt)("p",null,"You'll also need to import your global styles in your ",(0,i.kt)("inlineCode",{parentName:"p"},"app/layout.js")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/layout.js"',filename:'"app/layout.js"'},'import "../styles/globals.css";\n\nexport default function RootLayout({ children }) {\n    return (\n        <html lang="en">\n            <body>{children}</body>\n        </html>\n    );\n}\n')),(0,i.kt)("p",null,"Learn more about ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/styling/tailwind-css"},"styling with Tailwind CSS")),(0,i.kt)("h2",{id:"codemods"},"Codemods"),(0,i.kt)("p",null,"Next.js provides Codemod transformations to help upgrade your codebase when a feature is deprecated. See ",(0,i.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/upgrading/codemods"},"Codemods")," for more information."))}c.isMDXComponent=!0}}]);