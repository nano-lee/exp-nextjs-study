"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[4472],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),l=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=l(e.components);return a.createElement(p.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(n),g=i,h=d["".concat(p,".").concat(g)]||d[g]||u[g]||r;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=g;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[d]="string"==typeof e?e:i,o[1]=s;for(var l=2;l<r;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},8098:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var a=n(7462),i=(n(7294),n(3905));const r={sidebar_position:1,title:"getStaticProps",description:"Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."},o=void 0,s={unversionedId:"pages/building-your-application/data-fetching/get-static-props",id:"pages/building-your-application/data-fetching/get-static-props",title:"getStaticProps",description:"Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js.",source:"@site/docs/03-pages/01-building-your-application/03-data-fetching/01-get-static-props.mdx",sourceDirName:"03-pages/01-building-your-application/03-data-fetching",slug:"/pages/building-your-application/data-fetching/get-static-props",permalink:"/docs/pages/building-your-application/data-fetching/get-static-props",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/03-pages/01-building-your-application/03-data-fetching/01-get-static-props.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"getStaticProps",description:"Fetch data and generate static pages with `getStaticProps`. Learn more about this API for data fetching in Next.js."},sidebar:"tutorialSidebar",previous:{title:"Data Fetching",permalink:"/docs/pages/building-your-application/data-fetching/"},next:{title:"getStaticPaths",permalink:"/docs/pages/building-your-application/data-fetching/get-static-paths"}},p={},l=[{value:"When should I use getStaticProps?",id:"when-should-i-use-getstaticprops",level:2},{value:"When does getStaticProps run",id:"when-does-getstaticprops-run",level:2},{value:"Using getStaticProps to fetch data from a CMS",id:"using-getstaticprops-to-fetch-data-from-a-cms",level:2},{value:"Write server-side code directly",id:"write-server-side-code-directly",level:2},{value:"Statically generates both HTML and JSON",id:"statically-generates-both-html-and-json",level:2},{value:"Where can I use getStaticProps",id:"where-can-i-use-getstaticprops",level:2},{value:"Runs on every request in development",id:"runs-on-every-request-in-development",level:2},{value:"Preview Mode",id:"preview-mode",level:2}],c={toc:l},d="wrapper";function u(e){let{components:t,...n}=e;return(0,i.kt)(d,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"If you export a function called ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," (Static Site Generation) from a page, Next.js will pre-render this page at build time using the props returned by ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="pages/index.tsx" switcher',filename:'"pages/index.tsx"',switcher:!0},'import type { InferGetStaticPropsType, GetStaticProps } from "next";\n\ntype Repo = {\n    name: string;\n    stargazers_count: number;\n};\n\nexport const getStaticProps = (async (context) => {\n    const res = await fetch("https://api.github.com/repos/vercel/next.js");\n    const repo = await res.json();\n    return { props: { repo } };\n}) satisfies GetStaticProps<{\n    repo: Repo;\n}>;\n\nexport default function Page({\n    repo,\n}: InferGetStaticPropsType<typeof getStaticProps>) {\n    return repo.stargazers_count;\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/index.js" switcher',filename:'"pages/index.js"',switcher:!0},'export async function getStaticProps() {\n    const res = await fetch("https://api.github.com/repos/vercel/next.js");\n    const repo = await res.json();\n    return { props: { repo } };\n}\n\nexport default function Page({ repo }) {\n    return repo.stargazers_count;\n}\n')),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Note that irrespective of rendering type, any ",(0,i.kt)("inlineCode",{parentName:"p"},"props")," will be passed to the page component and can be viewed on the client-side in the initial HTML. This is to allow the page to be ",(0,i.kt)("a",{parentName:"p",href:"https://react.dev/reference/react-dom/hydrate"},"hydrated")," correctly. Make sure that you don't pass any sensitive information that shouldn't be available on the client in ",(0,i.kt)("inlineCode",{parentName:"p"},"props"),".")),(0,i.kt)("h2",{id:"when-should-i-use-getstaticprops"},"When should I use getStaticProps?"),(0,i.kt)("p",null,"You should use ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," if:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The data required to render the page is available at build time ahead of a user\u2019s request"),(0,i.kt)("li",{parentName:"ul"},"The data comes from a headless CMS"),(0,i.kt)("li",{parentName:"ul"},"The page must be pre-rendered (for SEO) and be very fast \u2014 ",(0,i.kt)("inlineCode",{parentName:"li"},"getStaticProps")," generates ",(0,i.kt)("inlineCode",{parentName:"li"},"HTML")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"JSON")," files, both of which can be cached by a CDN for performance"),(0,i.kt)("li",{parentName:"ul"},"The data can be publicly cached (not user-specific). This condition can be bypassed in certain specific situation by using a Middleware to rewrite the path.")),(0,i.kt)("h2",{id:"when-does-getstaticprops-run"},"When does getStaticProps run"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," always runs on the server and never on the client. You can validate code written inside ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," is removed from the client-side bundle ",(0,i.kt)("a",{parentName:"p",href:"https://next-code-elimination.vercel.app/"},"with this tool"),"."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"getStaticProps")," always runs during ",(0,i.kt)("inlineCode",{parentName:"li"},"next build")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"getStaticProps")," runs in the background when using ",(0,i.kt)("a",{parentName:"li",href:"/docs/pages/api-reference/functions/get-static-paths#fallback-true"},(0,i.kt)("inlineCode",{parentName:"a"},"fallback: true"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"getStaticProps")," is called before initial render when using ",(0,i.kt)("a",{parentName:"li",href:"/docs/pages/api-reference/functions/get-static-paths#fallback-blocking"},(0,i.kt)("inlineCode",{parentName:"a"},"fallback: blocking"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"getStaticProps")," runs in the background when using ",(0,i.kt)("inlineCode",{parentName:"li"},"revalidate")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"getStaticProps")," runs on-demand in the background when using ",(0,i.kt)("a",{parentName:"li",href:"/docs/pages/building-your-application/data-fetching/incremental-static-regeneration#on-demand-revalidation"},(0,i.kt)("inlineCode",{parentName:"a"},"revalidate()")))),(0,i.kt)("p",null,"When combined with ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/building-your-application/data-fetching/incremental-static-regeneration"},"Incremental Static Regeneration"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," will run in the background while the stale page is being revalidated, and the fresh page served to the browser."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," does not have access to the incoming request (such as query parameters or HTTP headers) as it generates static HTML. If you need access to the request for your page, consider using ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/building-your-application/routing/middleware"},"Middleware")," in addition to ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps"),"."),(0,i.kt)("h2",{id:"using-getstaticprops-to-fetch-data-from-a-cms"},"Using getStaticProps to fetch data from a CMS"),(0,i.kt)("p",null,"The following example shows how you can fetch a list of blog posts from a CMS."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="pages/blog.tsx" switcher',filename:'"pages/blog.tsx"',switcher:!0},'// posts will be populated at build time by getStaticProps()\nexport default function Blog({ posts }) {\n    return (\n        <ul>\n            {posts.map((post) => (\n                <li>{post.title}</li>\n            ))}\n        </ul>\n    );\n}\n\n// This function gets called at build time on server-side.\n// It won\'t be called on client-side, so you can even do\n// direct database queries.\nexport async function getStaticProps() {\n    // Call an external API endpoint to get posts.\n    // You can use any data fetching library\n    const res = await fetch("https://.../posts");\n    const posts = await res.json();\n\n    // By returning { props: { posts } }, the Blog component\n    // will receive `posts` as a prop at build time\n    return {\n        props: {\n            posts,\n        },\n    };\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/blog.js" switcher',filename:'"pages/blog.js"',switcher:!0},'// posts will be populated at build time by getStaticProps()\nexport default function Blog({ posts }) {\n    return (\n        <ul>\n            {posts.map((post) => (\n                <li>{post.title}</li>\n            ))}\n        </ul>\n    );\n}\n\n// This function gets called at build time on server-side.\n// It won\'t be called on client-side, so you can even do\n// direct database queries.\nexport async function getStaticProps() {\n    // Call an external API endpoint to get posts.\n    // You can use any data fetching library\n    const res = await fetch("https://.../posts");\n    const posts = await res.json();\n\n    // By returning { props: { posts } }, the Blog component\n    // will receive `posts` as a prop at build time\n    return {\n        props: {\n            posts,\n        },\n    };\n}\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/api-reference/functions/get-static-props"},(0,i.kt)("inlineCode",{parentName:"a"},"getStaticProps")," API reference")," covers all parameters and props that can be used with ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps"),"."),(0,i.kt)("h2",{id:"write-server-side-code-directly"},"Write server-side code directly"),(0,i.kt)("p",null,"As ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," runs only on the server-side, it will never run on the client-side. It won\u2019t even be included in the JS bundle for the browser, so you can write direct database queries without them being sent to browsers."),(0,i.kt)("p",null,"This means that instead of fetching an ",(0,i.kt)("strong",{parentName:"p"},"API route")," from ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," (that itself fetches data from an external source), you can write the server-side code directly in ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps"),"."),(0,i.kt)("p",null,"Take the following example. An API route is used to fetch some data from a CMS. That API route is then called directly from ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps"),". This produces an additional call, reducing performance. Instead, the logic for fetching the data from the CMS can be shared by using a ",(0,i.kt)("inlineCode",{parentName:"p"},"lib/")," directory. Then it can be shared with ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="lib/load-posts.js"',filename:'"lib/load-posts.js"'},'// The following function is shared\n// with getStaticProps and API routes\n// from a `lib/` directory\nexport async function loadPosts() {\n    // Call an external API endpoint to get posts\n    const res = await fetch("https://.../posts/");\n    const data = await res.json();\n\n    return data;\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="pages/blog.js"',filename:'"pages/blog.js"'},'// pages/blog.js\nimport { loadPosts } from "../lib/load-posts";\n\n// This function runs only on the server side\nexport async function getStaticProps() {\n    // Instead of fetching your `/api` route you can call the same\n    // function directly in `getStaticProps`\n    const posts = await loadPosts();\n\n    // Props returned will be passed to the page component\n    return { props: { posts } };\n}\n')),(0,i.kt)("p",null,"Alternatively, if you are ",(0,i.kt)("strong",{parentName:"p"},"not")," using API routes to fetch data, then the ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/docs/Web/API/Fetch_API"},(0,i.kt)("inlineCode",{parentName:"a"},"fetch()"))," API ",(0,i.kt)("em",{parentName:"p"},"can")," be used directly in ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," to fetch data."),(0,i.kt)("p",null,"To verify what Next.js eliminates from the client-side bundle, you can use the ",(0,i.kt)("a",{parentName:"p",href:"https://next-code-elimination.vercel.app/"},"next-code-elimination tool"),"."),(0,i.kt)("h2",{id:"statically-generates-both-html-and-json"},"Statically generates both HTML and JSON"),(0,i.kt)("p",null,"When a page with ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," is pre-rendered at build time, in addition to the page HTML file, Next.js generates a JSON file holding the result of running ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps"),"."),(0,i.kt)("p",null,"This JSON file will be used in client-side routing through ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/api-reference/components/link"},(0,i.kt)("inlineCode",{parentName:"a"},"next/link"))," or ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/api-reference/functions/use-router"},(0,i.kt)("inlineCode",{parentName:"a"},"next/router")),". When you navigate to a page that\u2019s pre-rendered using ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps"),", Next.js fetches this JSON file (pre-computed at build time) and uses it as the props for the page component. This means that client-side page transitions will ",(0,i.kt)("strong",{parentName:"p"},"not")," call ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," as only the exported JSON is used."),(0,i.kt)("p",null,"When using Incremental Static Generation, ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," will be executed in the background to generate the JSON needed for client-side navigation. You may see this in the form of multiple requests being made for the same page, however, this is intended and has no impact on end-user performance."),(0,i.kt)("h2",{id:"where-can-i-use-getstaticprops"},"Where can I use getStaticProps"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," can only be exported from a ",(0,i.kt)("strong",{parentName:"p"},"page"),". You ",(0,i.kt)("strong",{parentName:"p"},"cannot")," export it from non-page files, ",(0,i.kt)("inlineCode",{parentName:"p"},"_app"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"_document"),", or ",(0,i.kt)("inlineCode",{parentName:"p"},"_error"),"."),(0,i.kt)("p",null,"One of the reasons for this restriction is that React needs to have all the required data before the page is rendered."),(0,i.kt)("p",null,"Also, you must use export ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," as a standalone function \u2014 it will ",(0,i.kt)("strong",{parentName:"p"},"not")," work if you add ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," as a property of the page component."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": if you have created a ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/building-your-application/routing/custom-app"},"custom app"),", ensure you are passing the ",(0,i.kt)("inlineCode",{parentName:"p"},"pageProps")," to the page component as shown in the linked document, otherwise the props will be empty.")),(0,i.kt)("h2",{id:"runs-on-every-request-in-development"},"Runs on every request in development"),(0,i.kt)("p",null,"In development (",(0,i.kt)("inlineCode",{parentName:"p"},"next dev"),"), ",(0,i.kt)("inlineCode",{parentName:"p"},"getStaticProps")," will be called on every request."),(0,i.kt)("h2",{id:"preview-mode"},"Preview Mode"),(0,i.kt)("p",null,"You can temporarily bypass static generation and render the page at ",(0,i.kt)("strong",{parentName:"p"},"request time")," instead of build time using ",(0,i.kt)("a",{parentName:"p",href:"/docs/pages/building-your-application/configuring/preview-mode"},(0,i.kt)("strong",{parentName:"a"},"Preview Mode")),". For example, you might be using a headless CMS and want to preview drafts before they're published."))}u.isMDXComponent=!0}}]);