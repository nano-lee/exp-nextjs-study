"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[365],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=s(n),c=i,h=u["".concat(p,".").concat(c)]||u[c]||d[c]||r;return n?a.createElement(h,o(o({ref:t},m),{},{components:n})):a.createElement(h,o({ref:t},m))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:i,o[1]=l;for(var s=2;s<r;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},9419:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var a=n(7462),i=(n(7294),n(3905));const r={sidebar_position:8,title:"Next.js CLI",description:"The Next.js CLI allows you to start, build, and export your application. Learn more about it here."},o=void 0,l={unversionedId:"app/api-reference/next-cli",id:"app/api-reference/next-cli",title:"Next.js CLI",description:"The Next.js CLI allows you to start, build, and export your application. Learn more about it here.",source:"@site/docs/02-app/02-api-reference/08-next-cli.mdx",sourceDirName:"02-app/02-api-reference",slug:"/app/api-reference/next-cli",permalink:"/nano-nextjs-study/docs/app/api-reference/next-cli",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-app/02-api-reference/08-next-cli.mdx",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8,title:"Next.js CLI",description:"The Next.js CLI allows you to start, build, and export your application. Learn more about it here."},sidebar:"tutorialSidebar",previous:{title:"Edge Runtime",permalink:"/nano-nextjs-study/docs/app/api-reference/edge"},next:{title:"Pages Router",permalink:"/nano-nextjs-study/docs/pages/"}},p={},s=[{value:"Build",id:"build",level:2},{value:"Development",id:"development",level:2},{value:"Production",id:"production",level:2},{value:"Keep Alive Timeout",id:"keep-alive-timeout",level:3},{value:"Lint",id:"lint",level:2},{value:"Telemetry",id:"telemetry",level:2},{value:"Next Info",id:"next-info",level:2}],m={toc:s},u="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(u,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"{/",(0,i.kt)("em",{parentName:"p"}," The content of this doc is shared between the app and pages router. You can use the  component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. "),"/}"),(0,i.kt)("p",null,"The Next.js CLI allows you to start, build, and export your application."),(0,i.kt)("p",null,"To get a list of the available CLI commands, run the following command inside your project directory:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npx next -h\n")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"(",(0,i.kt)("a",{parentName:"em",href:"https://medium.com/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b"},"npx")," comes with npm 5.2+ and higher)")),(0,i.kt)("p",null,"The output should look like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"Usage\n  $ next <command>\n\nAvailable commands\n  build, start, export, dev, lint, telemetry, info\n\nOptions\n  --version, -v   Version number\n  --help, -h      Displays this message\n\nFor more information run a command with the --help flag\n  $ next build --help\n")),(0,i.kt)("p",null,"You can pass any ",(0,i.kt)("a",{parentName:"p",href:"https://nodejs.org/api/cli.html#cli_node_options_options"},"node arguments")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"next")," commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"NODE_OPTIONS='--throw-deprecation' next\nNODE_OPTIONS='-r esm' next\nNODE_OPTIONS='--inspect' next\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": Running ",(0,i.kt)("inlineCode",{parentName:"p"},"next")," without a command is the same as running ",(0,i.kt)("inlineCode",{parentName:"p"},"next dev"))),(0,i.kt)("h2",{id:"build"},"Build"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"next build")," creates an optimized production build of your application. The output displays information about each route."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Size")," \u2013 The number of assets downloaded when navigating to the page client-side. The size for each route only includes its dependencies."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"First Load JS")," \u2013 The number of assets downloaded when visiting the page from the server. The amount of JS shared by all is shown as a separate metric.")),(0,i.kt)("p",null,"Both of these values are ",(0,i.kt)("strong",{parentName:"p"},"compressed with gzip"),". The first load is indicated by green, yellow, or red. Aim for green for performant applications."),(0,i.kt)("p",null,"You can enable production profiling for React with the ",(0,i.kt)("inlineCode",{parentName:"p"},"--profile")," flag in ",(0,i.kt)("inlineCode",{parentName:"p"},"next build"),". This requires ",(0,i.kt)("a",{parentName:"p",href:"https://nextjs.org/blog/next-9-5"},"Next.js 9.5"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"next build --profile\n")),(0,i.kt)("p",null,"After that, you can use the profiler in the same way as you would in development."),(0,i.kt)("p",null,"You can enable more verbose build output with the ",(0,i.kt)("inlineCode",{parentName:"p"},"--debug")," flag in ",(0,i.kt)("inlineCode",{parentName:"p"},"next build"),". This requires Next.js 9.5.3:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"next build --debug\n")),(0,i.kt)("p",null,"With this flag enabled additional build output like rewrites, redirects, and headers will be shown."),(0,i.kt)("h2",{id:"development"},"Development"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"next dev")," starts the application in development mode with hot-code reloading, error reporting, and more:"),(0,i.kt)("p",null,"The application will start at ",(0,i.kt)("inlineCode",{parentName:"p"},"http://localhost:3000")," by default. The default port can be changed with ",(0,i.kt)("inlineCode",{parentName:"p"},"-p"),", like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npx next dev -p 4000\n")),(0,i.kt)("p",null,"Or using the ",(0,i.kt)("inlineCode",{parentName:"p"},"PORT")," environment variable:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"PORT=4000 npx next dev\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"PORT")," cannot be set in ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," as booting up the HTTP server happens before any other code is initialized.")),(0,i.kt)("p",null,"You can also set the hostname to be different from the default of ",(0,i.kt)("inlineCode",{parentName:"p"},"0.0.0.0"),", this can be useful for making the application available for other devices on the network. The default hostname can be changed with ",(0,i.kt)("inlineCode",{parentName:"p"},"-H"),", like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npx next dev -H 192.168.1.2\n")),(0,i.kt)("h2",{id:"production"},"Production"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"next start")," starts the application in production mode. The application should be compiled with ",(0,i.kt)("a",{parentName:"p",href:"#build"},(0,i.kt)("inlineCode",{parentName:"a"},"next build"))," first."),(0,i.kt)("p",null,"The application will start at ",(0,i.kt)("inlineCode",{parentName:"p"},"http://localhost:3000")," by default. The default port can be changed with ",(0,i.kt)("inlineCode",{parentName:"p"},"-p"),", like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npx next start -p 4000\n")),(0,i.kt)("p",null,"Or using the ",(0,i.kt)("inlineCode",{parentName:"p"},"PORT")," environment variable:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"PORT=4000 npx next start\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"Good to know"),":"),(0,i.kt)("p",{parentName:"blockquote"},"-",(0,i.kt)("inlineCode",{parentName:"p"},"PORT")," cannot be set in ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," as booting up the HTTP server happens before any other code is initialized."),(0,i.kt)("ul",{parentName:"blockquote"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"next start")," cannot be used with ",(0,i.kt)("inlineCode",{parentName:"li"},"output: 'standalone'")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"output: 'export'"),"."))),(0,i.kt)("h3",{id:"keep-alive-timeout"},"Keep Alive Timeout"),(0,i.kt)("p",null,"When deploying Next.js behind a downstream proxy (e.g. a load-balancer like AWS ELB/ALB) it's important to configure Next's underlying HTTP server with ",(0,i.kt)("a",{parentName:"p",href:"https://nodejs.org/api/http.html#http_server_keepalivetimeout"},"keep-alive timeouts")," that are ",(0,i.kt)("em",{parentName:"p"},"larger")," than the downstream proxy's timeouts. Otherwise, once a keep-alive timeout is reached for a given TCP connection, Node.js will immediately terminate that connection without notifying the downstream proxy. This results in a proxy error whenever it attempts to reuse a connection that Node.js has already terminated."),(0,i.kt)("p",null,"To configure the timeout values for the production Next.js server, pass ",(0,i.kt)("inlineCode",{parentName:"p"},"--keepAliveTimeout")," (in milliseconds) to ",(0,i.kt)("inlineCode",{parentName:"p"},"next start"),", like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"npx next start --keepAliveTimeout 70000\n")),(0,i.kt)("h2",{id:"lint"},"Lint"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"next lint")," runs ESLint for all files in the ",(0,i.kt)("inlineCode",{parentName:"p"},"pages/"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"app/"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"components/"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"lib/"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"src/")," directories. It also\nprovides a guided setup to install any required dependencies if ESLint is not already configured in\nyour application."),(0,i.kt)("p",null,"If you have other directories that you would like to lint, you can specify them using the ",(0,i.kt)("inlineCode",{parentName:"p"},"--dir"),"\nflag:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"next lint --dir utils\n")),(0,i.kt)("h2",{id:"telemetry"},"Telemetry"),(0,i.kt)("p",null,"Next.js collects ",(0,i.kt)("strong",{parentName:"p"},"completely anonymous")," telemetry data about general usage.\nParticipation in this anonymous program is optional, and you may opt-out if you'd not like to share any information."),(0,i.kt)("p",null,"To learn more about Telemetry, ",(0,i.kt)("a",{parentName:"p",href:"https://nextjs.org/telemetry/"},"please read this document"),"."),(0,i.kt)("h2",{id:"next-info"},"Next Info"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"next info")," prints relevant details about the current system which can be used to report Next.js bugs.\nThis information includes Operating System platform/arch/version, Binaries (Node.js, npm, Yarn, pnpm) and npm package versions (",(0,i.kt)("inlineCode",{parentName:"p"},"next"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"react"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"react-dom"),")."),(0,i.kt)("p",null,"Running the following in your project's root directory:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"next info\n")),(0,i.kt)("p",null,"will give you information like this example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash",metastring:'filename="Terminal"',filename:'"Terminal"'},"\nOperating System:\n  Platform: linux\n  Arch: x64\n  Version: #22-Ubuntu SMP Fri Nov 5 13:21:36 UTC 2021\nBinaries:\n  Node: 16.13.0\n  npm: 8.1.0\n  Yarn: 1.22.17\n  pnpm: 6.24.2\nRelevant packages:\n  next: 12.0.8\n  react: 17.0.2\n  react-dom: 17.0.2\n\n")),(0,i.kt)("p",null,"This information should then be pasted into GitHub Issues."),(0,i.kt)("p",null,"In order to diagnose installation issues, you can run ",(0,i.kt)("inlineCode",{parentName:"p"},"next info --verbose")," to print additional information about system and the installation of next-related packages."))}d.isMDXComponent=!0}}]);