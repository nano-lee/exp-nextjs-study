"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[2161],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=s(n),m=r,g=c["".concat(p,".").concat(m)]||c[m]||d[m]||i;return n?a.createElement(g,o(o({ref:t},u),{},{components:n})):a.createElement(g,o({ref:t},u))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[c]="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},957:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));const i={sidebar_position:1,title:"Static Exports",description:"Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."},o=void 0,l={unversionedId:"app/building-your-application/deploying/static-exports",id:"app/building-your-application/deploying/static-exports",title:"Static Exports",description:"Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server.",source:"@site/docs/02-app/01-building-your-application/08-deploying/01-static-exports.mdx",sourceDirName:"02-app/01-building-your-application/08-deploying",slug:"/app/building-your-application/deploying/static-exports",permalink:"/docs/app/building-your-application/deploying/static-exports",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02-app/01-building-your-application/08-deploying/01-static-exports.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Static Exports",description:"Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."},sidebar:"tutorialSidebar",previous:{title:"Deploying",permalink:"/docs/app/building-your-application/deploying/"},next:{title:"Upgrading",permalink:"/docs/app/building-your-application/upgrading/"}},p={},s=[{value:"Configuration",id:"configuration",level:2},{value:"Supported Features",id:"supported-features",level:2},{value:"Server Components",id:"server-components",level:3},{value:"Client Components",id:"client-components",level:3},{value:"Image Optimization",id:"image-optimization",level:3},{value:"Route Handlers",id:"route-handlers",level:3},{value:"Browser APIs",id:"browser-apis",level:3},{value:"Unsupported Features",id:"unsupported-features",level:2},{value:"Deploying",id:"deploying",level:2},{value:"Version History",id:"version-history",level:2}],u={toc:s},c="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"{/",(0,r.kt)("em",{parentName:"p"}," The content of this doc is shared between the app and pages router. You can use the  component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. "),"/}"),(0,r.kt)("p",null,"Next.js enables starting as a static site or Single-Page Application (SPA), then later optionally upgrading to use features that require a server."),(0,r.kt)("p",null,"When running ",(0,r.kt)("inlineCode",{parentName:"p"},"next build"),", Next.js generates an HTML file per route. By breaking a strict SPA into individual HTML files, Next.js can avoid loading unnecessary JavaScript code on the client-side, reducing the bundle size and enabling faster page loads."),(0,r.kt)("p",null,"Since Next.js supports this static export, it can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets."),(0,r.kt)("h2",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"To enable a static export, change the output mode inside ",(0,r.kt)("inlineCode",{parentName:"p"},"next.config.js"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="next.config.js" highlight={5}',filename:'"next.config.js"',highlight:"{5}"},"/**\n * @type {import('next').NextConfig}\n */\nconst nextConfig = {\n    output: \"export\",\n\n    // Optional: Change links `/me` -> `/me/` and emit `/me.html` -> `/me/index.html`\n    // trailingSlash: true,\n\n    // Optional: Prevent automatic `/me` -> `/me/`, instead preserve `href`\n    // skipTrailingSlashRedirect: true,\n\n    // Optional: Change the output directory `out` -> `dist`\n    // distDir: 'dist',\n};\n\nmodule.exports = nextConfig;\n")),(0,r.kt)("p",null,"After running ",(0,r.kt)("inlineCode",{parentName:"p"},"next build"),", Next.js will produce an ",(0,r.kt)("inlineCode",{parentName:"p"},"out")," folder which contains the HTML/CSS/JS assets for your application."),(0,r.kt)("h2",{id:"supported-features"},"Supported Features"),(0,r.kt)("p",null,"The core of Next.js has been designed to support static exports."),(0,r.kt)("h3",{id:"server-components"},"Server Components"),(0,r.kt)("p",null,"When you run ",(0,r.kt)("inlineCode",{parentName:"p"},"next build")," to generate a static export, Server Components consumed inside the ",(0,r.kt)("inlineCode",{parentName:"p"},"app")," directory will run during the build, similar to traditional static-site generation."),(0,r.kt)("p",null,"The resulting component will be rendered into static HTML for the initial page load and a static payload for client navigation between routes. No changes are required for your Server Components when using the static export, unless they consume ",(0,r.kt)("a",{parentName:"p",href:"#unsupported-features"},"dynamic server functions"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/page.tsx" switcher',filename:'"app/page.tsx"',switcher:!0},'export default async function Page() {\n    // This fetch will run on the server during `next build`\n    const res = await fetch("https://api.example.com/...");\n    const data = await res.json();\n\n    return <main>...</main>;\n}\n')),(0,r.kt)("h3",{id:"client-components"},"Client Components"),(0,r.kt)("p",null,"If you want to perform data fetching on the client, you can use a Client Component with ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/vercel/swr"},"SWR")," to memoize requests."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/other/page.tsx" switcher',filename:'"app/other/page.tsx"',switcher:!0},'"use client";\n\nimport useSWR from "swr";\n\nconst fetcher = (url: string) => fetch(url).then((r) => r.json());\n\nexport default function Page() {\n    const { data, error } = useSWR(\n        `https://jsonplaceholder.typicode.com/posts/1`,\n        fetcher,\n    );\n    if (error) return "Failed to load";\n    if (!data) return "Loading...";\n\n    return data.title;\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/other/page.js" switcher',filename:'"app/other/page.js"',switcher:!0},'"use client";\n\nimport useSWR from "swr";\n\nconst fetcher = (url) => fetch(url).then((r) => r.json());\n\nexport default function Page() {\n    const { data, error } = useSWR(\n        `https://jsonplaceholder.typicode.com/posts/1`,\n        fetcher,\n    );\n    if (error) return "Failed to load";\n    if (!data) return "Loading...";\n\n    return data.title;\n}\n')),(0,r.kt)("p",null,"Since route transitions happen client-side, this behaves like a traditional SPA. For example, the following index route allows you to navigate to different posts on the client:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/page.tsx" switcher',filename:'"app/page.tsx"',switcher:!0},'import Link from "next/link";\n\nexport default function Page() {\n    return (\n        <>\n            <h1>Index Page</h1>\n            <hr />\n            <ul>\n                <li>\n                    <Link href="/post/1">Post 1</Link>\n                </li>\n                <li>\n                    <Link href="/post/2">Post 2</Link>\n                </li>\n            </ul>\n        </>\n    );\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/page.js" switcher',filename:'"app/page.js"',switcher:!0},'import Link from "next/link";\n\nexport default function Page() {\n    return (\n        <>\n            <h1>Index Page</h1>\n            <p>\n                <Link href="/other">Other Page</Link>\n            </p>\n        </>\n    );\n}\n')),(0,r.kt)("h3",{id:"image-optimization"},"Image Optimization"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/docs/app/building-your-application/optimizing/images"},"Image Optimization")," through ",(0,r.kt)("inlineCode",{parentName:"p"},"next/image")," can be used with a static export by defining a custom image loader in ",(0,r.kt)("inlineCode",{parentName:"p"},"next.config.js"),". For example, you can optimize images with a service like Cloudinary:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="next.config.js"',filename:'"next.config.js"'},'/** @type {import(\'next\').NextConfig} */\nconst nextConfig = {\n    output: "export",\n    images: {\n        loader: "custom",\n        loaderFile: "./my-loader.ts",\n    },\n};\n\nmodule.exports = nextConfig;\n')),(0,r.kt)("p",null,"This custom loader will define how to fetch images from a remote source. For example, the following loader will construct the URL for Cloudinary:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'filename="my-loader.ts" switcher',filename:'"my-loader.ts"',switcher:!0},'export default function cloudinaryLoader({\n    src,\n    width,\n    quality,\n}: {\n    src: string;\n    width: number;\n    quality?: number;\n}) {\n    const params = [\n        "f_auto",\n        "c_limit",\n        `w_${width}`,\n        `q_${quality || "auto"}`,\n    ];\n    return `https://res.cloudinary.com/demo/image/upload/${params.join(\n        ",",\n    )}${src}`;\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="my-loader.js" switcher',filename:'"my-loader.js"',switcher:!0},'export default function cloudinaryLoader({ src, width, quality }) {\n    const params = [\n        "f_auto",\n        "c_limit",\n        `w_${width}`,\n        `q_${quality || "auto"}`,\n    ];\n    return `https://res.cloudinary.com/demo/image/upload/${params.join(\n        ",",\n    )}${src}`;\n}\n')),(0,r.kt)("p",null,"You can then use ",(0,r.kt)("inlineCode",{parentName:"p"},"next/image")," in your application, defining relative paths to the image in Cloudinary:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'filename="app/page.tsx" switcher',filename:'"app/page.tsx"',switcher:!0},'import Image from "next/image";\n\nexport default function Page() {\n    return <Image alt="turtles" src="/turtles.jpg" width={300} height={300} />;\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'filename="app/page.js" switcher',filename:'"app/page.js"',switcher:!0},'import Image from "next/image";\n\nexport default function Page() {\n    return <Image alt="turtles" src="/turtles.jpg" width={300} height={300} />;\n}\n')),(0,r.kt)("h3",{id:"route-handlers"},"Route Handlers"),(0,r.kt)("p",null,"Route Handlers will render a static response when running ",(0,r.kt)("inlineCode",{parentName:"p"},"next build"),". Only the ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," HTTP verb is supported. This can be used to generate static HTML, JSON, TXT, or other files from cached or uncached data. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'filename="app/data.json/route.ts" switcher',filename:'"app/data.json/route.ts"',switcher:!0},'export async function GET() {\n    return Response.json({ name: "Lee" });\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'filename="app/data.json/route.js" switcher',filename:'"app/data.json/route.js"',switcher:!0},'export async function GET() {\n    return Response.json({ name: "Lee" });\n}\n')),(0,r.kt)("p",null,"The above file ",(0,r.kt)("inlineCode",{parentName:"p"},"app/data.json/route.ts")," will render to a static file during ",(0,r.kt)("inlineCode",{parentName:"p"},"next build"),", producing ",(0,r.kt)("inlineCode",{parentName:"p"},"data.json")," containing ",(0,r.kt)("inlineCode",{parentName:"p"},"{ name: 'Lee' }"),"."),(0,r.kt)("p",null,"If you need to read dynamic values from the incoming request, you cannot use a static export."),(0,r.kt)("h3",{id:"browser-apis"},"Browser APIs"),(0,r.kt)("p",null,"Client Components are pre-rendered to HTML during ",(0,r.kt)("inlineCode",{parentName:"p"},"next build"),". Because ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/docs/Web/API"},"Web APIs")," like ",(0,r.kt)("inlineCode",{parentName:"p"},"window"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"localStorage"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"navigator")," are not available on the server, you need to safely access these APIs only when running in the browser. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"'use client';\n\nimport { useEffect } from 'react';\n\nexport default function ClientComponent() {\n  useEffect(() => {\n    // You now have access to `window`\n    console.log(window.innerHeight);\n  }, [])\n\n  return ...;\n}\n")),(0,r.kt)("h2",{id:"unsupported-features"},"Unsupported Features"),(0,r.kt)("p",null,"Features that require a Node.js server, or dynamic logic that cannot be computed during the build process, are ",(0,r.kt)("strong",{parentName:"p"},"not")," supported:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing/dynamic-routes"},"Dynamic Routes")," with ",(0,r.kt)("inlineCode",{parentName:"li"},"dynamicParams: true")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing/dynamic-routes"},"Dynamic Routes")," without ",(0,r.kt)("inlineCode",{parentName:"li"},"generateStaticParams()")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing/route-handlers"},"Route Handlers")," that rely on Request"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/api-reference/functions/cookies"},"Cookies")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/api-reference/next-config-js/rewrites"},"Rewrites")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/api-reference/next-config-js/redirects"},"Redirects")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/api-reference/next-config-js/headers"},"Headers")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/routing/middleware"},"Middleware")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating"},"Incremental Static Regeneration")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/optimizing/images"},"Image Optimization")," with the default ",(0,r.kt)("inlineCode",{parentName:"li"},"loader")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/app/building-your-application/configuring/draft-mode"},"Draft Mode"))),(0,r.kt)("p",null,"Attempting to use any of these features with ",(0,r.kt)("inlineCode",{parentName:"p"},"next dev")," will result in an error, similar to setting the ",(0,r.kt)("a",{parentName:"p",href:"/docs/app/api-reference/file-conventions/route-segment-config#dynamic"},(0,r.kt)("inlineCode",{parentName:"a"},"dynamic"))," option to ",(0,r.kt)("inlineCode",{parentName:"p"},"error")," in the root layout."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'export const dynamic = "error";\n')),(0,r.kt)("h2",{id:"deploying"},"Deploying"),(0,r.kt)("p",null,"With a static export, Next.js can be deployed and hosted on any web server that can serve HTML/CSS/JS static assets."),(0,r.kt)("p",null,"When running ",(0,r.kt)("inlineCode",{parentName:"p"},"next build"),", Next.js generates the static export into the ",(0,r.kt)("inlineCode",{parentName:"p"},"out")," folder. For example, let's say you have the following routes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"/")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"/blog/[id]"))),(0,r.kt)("p",null,"After running ",(0,r.kt)("inlineCode",{parentName:"p"},"next build"),", Next.js will generate the following files:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"/out/index.html")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"/out/404.html")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"/out/blog/post-1.html")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"/out/blog/post-2.html"))),(0,r.kt)("p",null,"If you are using a static host like Nginx, you can configure rewrites from incoming requests to the correct files:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-nginx",metastring:'filename="nginx.conf"',filename:'"nginx.conf"'},"server {\n  listen 80;\n  server_name acme.com;\n\n  root /var/www/out;\n\n  location / {\n      try_files $uri $uri.html $uri/ =404;\n  }\n\n  # This is necessary when `trailingSlash: false`.\n  # You can omit this when `trailingSlash: true`.\n  location /blog/ {\n      rewrite ^/blog/(.*)$ /blog/$1.html break;\n  }\n\n  error_page 404 /404.html;\n  location = /404.html {\n      internal;\n  }\n}\n")),(0,r.kt)("h2",{id:"version-history"},"Version History"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Version"),(0,r.kt)("th",{parentName:"tr",align:null},"Changes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"v14.0.0")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"next export")," has been removed in favor of ",(0,r.kt)("inlineCode",{parentName:"td"},'"output": "export"'))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"v13.4.0")),(0,r.kt)("td",{parentName:"tr",align:null},"App Router (Stable) adds enhanced static export support, including using React Server Components and Route Handlers.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"v13.3.0")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"next export")," is deprecated and replaced with ",(0,r.kt)("inlineCode",{parentName:"td"},'"output": "export"'))))))}d.isMDXComponent=!0}}]);